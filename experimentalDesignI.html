<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>Experimenteel Design I: replicatie en power</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biostatistiek</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Hoorcolleges
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductie</a>
    </li>
    <li>
      <a href="10-MultipleRegression.html">Algemeen Lineair Model</a>
    </li>
    <li>
      <a href="10-MultipleRegression-FactorialDesigns.html">Factoriële Designs</a>
    </li>
    <li>
      <a href="experimentalDesignI.html">Experimental Design I</a>
    </li>
    <li>
      <a href="experimentalDesignII.html">Experimental Design II</a>
    </li>
  </ul>
</li>
<li class="dropdown-header">Labs</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/biostatistics">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Experimenteel Design I: replicatie en
power</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a
href="https://statomics.github.io"
class="uri">https://statomics.github.io</a>)</h4>

</div>


<p><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a></p>
<p><img src="experimentalDesignI_files/figure-html/pop2Samp2Pop-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="concepten" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Concepten</h1>
<ul>
<li>Experimentele eenheden zijn subjecten, planten, proefdieren of
objecten die aan behandelingen worden onderworpen in een experimentele
studie.</li>
<li>Observationele eenheden zijn de subjecten, planten proefdieren of
objecten waarop we metingen doen. Meestal zijn de experimentele en
observationele eenheden hetzelfde. Als dat niet het geval is heeft met
vaak pseudoreplicatie.</li>
<li>Experimentele eenheden representatief voor populatie:
Randomisatie</li>
<li>Replicatie: technisch vs biologisch, steekproefgrootte - power</li>
<li>Bronnen van variabiliteit: technisch, biologisch, binnen en tussen
subjecten.</li>
</ul>
</div>
<div id="replicatie" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Replicatie</h1>
<p>Paper over replicatie in Nature Methods (2 pagina’s) [<a
href="https://www.nature.com/articles/nmeth.3091.pdf">PDF</a>] <embed
src="https://www.nature.com/articles/nmeth.3091.pdf"
style="width:100.0%" /></p>
<div id="voorbeeld" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Voorbeeld</h2>
<p>In een RNA-seq experiment willen de onderzoekers het effect nagaan
van een medicijn op de gen expressie.</p>
<p>Mogelijkse onderzoeksvraag</p>
<ul>
<li>Is er een verschil in gemiddelde gen expressie tussen behandelde en
niet behandelde samples</li>
</ul>
</div>
<div id="bronnen-van-variabiliteit" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bronnen van
variabiliteit</h2>
<p>TABLE 1 NATURE METHODS | VOL.11 NO.9 | SEPTEMBER 2014 | 879 - 880</p>
<table>
<colgroup>
<col width="35%" />
<col width="28%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="left">Replicate type</th>
<th align="center">Replicate category<span
class="math inline">\(^\text{a}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="left">Colonies</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Strains</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center">Animal study subjects</td>
<td align="left">Cohoused groups</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Gender</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Individuals</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Organs from sacrificed animals</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Methods for dissociating cells from tissue</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center">Sample preparation</td>
<td align="left">Dissociation runs from given tissue sample</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">Individual cells</td>
<td align="center">B</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="left">RNA-seq library construction</td>
<td align="center">T</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Runs from the library of a given cell</td>
<td align="center">T</td>
</tr>
<tr class="even">
<td align="center">Sequencing</td>
<td align="left">Reads from different transcript molecules</td>
<td align="center">V<span class="math inline">\(^\text{b}\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="left">Reads with unique molecular identifier (UMI) from a
given transcript molecule</td>
<td align="center">T</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Replicates are categorized as biological (B), technical (T) or of
variable type (V).</li>
<li>Sequence reads serve diverse purposes depending on the application
and how reads are used in analysis.</li>
</ol>
<hr />
</div>
<div id="op-welk-niveau-moeten-we-repliceren" class="section level2"
number="2.3">
<h2><span class="header-section-number">2.3</span> Op welk niveau moeten
we repliceren?</h2>
<ul>
<li><span
class="math inline">\(\text{var}(X)=\sigma^2_A+\sigma^2_C+\sigma^2_M=\sigma^2_{TOT}\)</span></li>
<li><span
class="math inline">\(\text{var}(\bar{X})=\frac{\sigma^2_A}{n_A}+\frac{\sigma^2_C}{n_A
n_C} + \frac{\sigma^2_M}{n_A n_C n_M}\)</span></li>
</ul>
<p><img
src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fnmeth.3091/MediaObjects/41592_2014_Article_BFnmeth3091_Fig1_HTML.jpg" />
Figure 1 NATURE METHODS | VOL.11 NO.9 | SEPTEMBER 2014 | 879 - 880</p>
<ol style="list-style-type: lower-alpha">
<li>Three levels of replication (two biological, one technical) with
animal, cell and measurement replicates normally distributed with a mean
across animals of 10 and ratio of variances 1:2:0.5. Solid green
(biological) and blue (technical) dots show how a measurement of the
expression (X = 12) samples from all three sources of variation.
Distribution s.d. is shown as horizontal lines.</li>
<li>Expression variance, Var(X), and variance of expression mean,
Var(<span class="math inline">\(\bar X\)</span>), computed across 10,000
simulations of nAnCnM = 48 measurements for unique combinations of the
number of animals (nA = 1 to 48), cells per animal (nC = 1 to 48) and
technical replicate measurements per cell (nM = 1 and 3). The ratio of
Var(X) and Var(<span class="math inline">\(\bar X\)</span>) is the
effective sample size, n, which corresponds to the equivalent number of
statistically independent measurements. Horizontal dashed lines
correspond to biological and total variation. Error bars on Var(X) show
s.d. from the 10,000 simulated samples (nM = 1).</li>
</ol>
<hr />
<p>Waar ligt interesse?</p>
<ul>
<li><p>Karakteriseren van bronnen van variabiliteit in experiment ==&gt;
technische en biologische repeats zijn nodig</p></li>
<li><p>Voornamelijke interesse in schatten van effect van behandeling
==&gt; focus op biologische repeats</p></li>
<li><p>Extra biologische repeats lumpen alle bronnen van variabiliteit:
biologische + technische variabiliteit.</p></li>
<li><p>Goed experimenteel design vereist na denken over replicatie</p>
<ol style="list-style-type: decimal">
<li>Identificeer onderzoeksvragen die men wenst te beantwoorden.</li>
<li>Breng bronnen van variabiliteit in kaart in elke stap van het
experiment</li>
<li>Let op voor pseudoreplicatie, beoog zoveel mogelijk onafhankelijke
repeats.</li>
</ol></li>
</ul>
<hr />
</div>
</div>
<div id="power-steekproefgrootte-en-andere-design-aspecten."
class="section level1" number="3">
<h1><span class="header-section-number">3</span> Power,
steekproefgrootte en andere design aspecten.</h1>
<p>Reading materials: <a
href="https://www.nature.com/articles/nmeth.2738.pdf">Nature Methods
(2013), 10(12), 1139–1140</a></p>
<div id="intermezzo-lineare-regression-in-matrix-vorm"
class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Intermezzo lineare
regression in matrix vorm</h2>
<ul>
<li>Lineaire regressie is een belangrijke methode in statistische data
analyse.</li>
</ul>
<div id="scalaire-vorm" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Scalaire vorm</h3>
<ul>
<li>Stel dat men voor elke experimentele eenheid <span
class="math inline">\(p\)</span> predictoren meet <span
class="math inline">\(\mathbf{x}=(x_1,\ldots,x_p)\)</span> en</li>
<li>continue respons <span class="math inline">\(Y\)</span></li>
<li>het linear regressiemodel kan dan worden geschreven als: <span
class="math display">\[
Y=f(\mathbf{x}) +\epsilon=\beta_0+\sum\limits_{j=1}^p x_j\beta_j +
\epsilon
\]</span> met i.i.d. <span class="math inline">\(\epsilon\sim
N(0,\sigma^2)\)</span></li>
</ul>
</div>
<div id="vectormatrix-vorm" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Vector/Matrix
vorm</h3>
<ul>
<li><span class="math inline">\(n\)</span> observatie <span
class="math inline">\((\mathbf{x}_1,y_1) \ldots
(\mathbf{x}_n,y_n)\)</span> with <span
class="math inline">\(\mathbf{x}_1^T=[1 x_1 \ldots x_p]\)</span></li>
<li>Regressie in matrix notatie <span
class="math display">\[\mathbf{Y}=\mathbf{X\beta} +
\mathbf{\epsilon}\]</span> met <span
class="math inline">\(\mathbf{Y}=\left[\begin{array}{c}y_1\\
\vdots\\y_n\end{array}\right]\)</span>, <span
class="math inline">\(\mathbf{X}=\left[\begin{array}{cccc}
1&amp;x_{11}&amp;\ldots&amp;x_{1p}\\ \vdots&amp;\vdots&amp;&amp;\vdots\\
1&amp;x_{n1}&amp;\ldots&amp;x_{np} \end{array}\right]\)</span> or <span
class="math inline">\(\mathbf{X}=\left[\begin{array}{c}
\mathbf{x}_1^T\\\vdots\\\mathbf{x}_n^T\end{array}\right]\)</span>, <span
class="math inline">\(\boldsymbol{\beta}=\left[\begin{array}{c}\beta_0\\
\vdots\\ \beta_p\end{array}\right]\)</span> and <span
class="math inline">\(\mathbf{\epsilon}=\left[\begin{array}{c}
\epsilon_1 \\ \vdots \\ \epsilon_n\end{array}\right]\)</span></li>
</ul>
<hr />
</div>
</div>
<div id="kleinste-kwadraten-techniekleast-squares-ls"
class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> kleinste kwadraten
techniek/Least Squares (LS)</h2>
<ul>
<li><p>Minimimaliseer de residuele kwadratensom <span
class="math display">\[\begin{eqnarray*}
RSS(\boldsymbol{\beta})&amp;=&amp;\sum\limits_{i=1}^n e^2_i\\
&amp;=&amp;\sum\limits_{i=1}^n \left(y_i-\beta_0-\sum\limits_{j=1}^p
x_{ij}\beta_j\right)^2
\end{eqnarray*}\]</span></p></li>
<li><p>of in matrix notatie</p></li>
</ul>
<p><span class="math display">\[
\text{RSS}(\boldsymbol{\beta})=(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X\beta})
\]</span></p>
<p><span class="math display">\[\rightarrow
\hat{\boldsymbol{\beta}}=\text{argmin}_\beta \text{
RSS}(\boldsymbol{\beta})\]</span></p>
<hr />
<div id="minimimaliseer-rss" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Minimimaliseer
RSS</h3>
<p><span class="math display">\[
\begin{array}{ccc}
\frac{\partial RSS}{\partial
\boldsymbol{\beta}}&amp;=&amp;\mathbf{0}\\\\
\frac{(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})}{\partial
\boldsymbol{\beta}}&amp;=&amp;\mathbf{0}\\\\
-2\mathbf{X}^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})&amp;=&amp;\mathbf{0}\\\\
\mathbf{X}^T\mathbf{X\beta}&amp;=&amp;\mathbf{X}^T\mathbf{Y}\\\\
\hat{\boldsymbol{\beta}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}
\end{array}
\]</span></p>
<hr />
</div>
</div>
<div id="variantie-schatter" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Variantie
schatter?</h2>
<p><span class="math display">\[
\begin{array}{ccl}
\hat{\boldsymbol{\Sigma}}_{\hat{\boldsymbol{\beta}}}
&amp;=&amp;\text{var}\left[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}\right]\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\text{var}\left[\mathbf{Y}\right]\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T(\mathbf{I}\sigma^2)\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{I}\quad\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
%\hat{\boldmath{\Sigma}}_{\hat{\boldsymbol{\beta}}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\text{var}\left[\mathbf{Y}\right](\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2
\end{array}
\]</span></p>
<p>De onzekerheid op model parameters hangt dus af van de residuele
variabiliteit en het de proefopzet!</p>
<ul>
<li><p>Hoe groter <span
class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> hoe meer
informatie het experiment zal hebben over de model parameters en hoe
kleiner hun variantie en standaard errors!</p></li>
<li><p>Factoriële designs?</p></li>
<li><p>Designs with continue predictoren?</p></li>
</ul>
<hr />
<p>De effectgrootte van interesse is typisch een lineaire combinatie van
de model parameters,<br />
<span class="math display">\[
l_0 \times \beta_0 + l_1 \times \beta_1 + ... + l_{p-1} \times
\beta_{p-1} = \mathbf{L}^T\boldsymbol{\beta}
\]</span></p>
<p>De nulhypothese van onze test kan dan worden geschreven als</p>
<p><span class="math display">\[
H_0: \mathbf{L}^T\boldsymbol{\beta} = 0
\]</span></p>
<p>vs de alternatieve hypothese</p>
<p><span class="math display">\[
H_1: \mathbf{L}^T\boldsymbol{\beta} \neq 0
\]</span></p>
<p>En het bewijs in het experiment tegen <span
class="math inline">\(H_0\)</span> kan worden gekwantificeerd met de
t-test statistiek:</p>
<p><span class="math display">\[
t=\frac{\mathbf{L}^T\hat{\boldsymbol{\beta}} -
0}{\text{se}_{\mathbf{L}^T\hat{\boldsymbol{\beta}}}}
\]</span> die een t-distributie volgt met n-p vrijheidsgraden onder de
nul hypothese als alle aannames van het model geldig zijn.</p>
<p>De kracht van de toets is dan</p>
<p><span class="math display">\[P(p &lt; 0.05 | H_1)\]</span> en hangt
af van</p>
<ul>
<li>de werkelijke effectgrootte in de populatie <span
class="math inline">\(\mathbf{L}^T\boldsymbol{\beta}\)</span>.</li>
<li>Het aantal observaties: SE en df van t-test.</li>
<li>Keuze van de designpunten</li>
<li>Keuze van significantie-niveau <span
class="math inline">\(\alpha\)</span>.</li>
</ul>
<p>We kunnen dit evalueren aan de hand van simulaties.</p>
</div>
<div id="muis-voorbeeld" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Muis voorbeeld</h2>
<ul>
<li><p>In 2021 publiceerden Choa et al. dat cytokine Thymic stromal
lymphopoietin (TSLP) vetverlies induceert bij muizen die een vet dieet
krijgen door de secretie van talg. [<a
href="https://www.science.org/doi/full/10.1126/science.abd2893">html</a>]
[<a
href="https://www.science.org/doi/pdf/10.1126/science.abd2893">PDF</a>]</p></li>
<li><p>Stel dat je een gelijkaardig experiment op wil zetten om na te
gaan of cytokine interleukin 25 (IL) ook een effect heeft op het gewicht
van muizen.</p></li>
<li><p>Je plant een studie met een controle groep muizen die een hoog
vet dieet krijgen (HFD) en een behandelingsgroep die een HFD dieet met
IL krijgt.</p></li>
<li><p>Wat is de vereiste steekproefgrootte om een bepaald effect op te
pikken van de behandeling?</p></li>
</ul>
<div id="hoe-zal-je-de-data-van-het-experiment-analyseren"
class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Hoe zal je de data
van het experiment analyseren?</h3>
<hr />
<ul>
<li><p><span class="math inline">\(H_0\)</span>: Er is geen verschil in
het gewicht van muizen die een dieet met IL krijgen en muizen die het
controle dieet krijgen.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: Het gewicht is
gemiddelde verschillend tussen muizen die het IL dieet krijgen en muizen
die het controle dieet krijgen.</p></li>
<li><p>Two sample t-test of een t-test op de helling van het lineaire
model met 1 dummy variabele</p></li>
</ul>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_\text{iIL} +
\epsilon_i\]</span></p>
<p><span class="math display">\[
\text{met }
X_\text{iIL}=\begin{cases}X_{iIL}=0 &amp; \text{HFD}\\X_{iIL}=1 &amp;
\text{HFD + IL}\end{cases}.
\]</span></p>
<ul>
<li>Geschatte effectgrootte?</li>
</ul>
<p><span class="math display">\[\hat\delta = \bar X_{IL} - \bar X_{c} =
\hat \beta_1\]</span></p>
<ul>
<li>Test statistiek <span class="math display">\[
T = \frac{\bar{X}_{IL}-\bar{X}_{c}}{SD_\text{pooled} \times
\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} =
\frac{\hat\beta_1}{\text{SE}_{\hat\beta_1}}
\]</span></li>
<li><span class="math inline">\(\hat \beta_1\)</span> is een
onvertekende schatter van het werkelijk gewichtsverschil (<span
class="math inline">\(\delta =\mu_{IL}-\mu_{c} = \beta_1\)</span>) dat
zou voorkomen in de populatie van muizen gevoed met HFD vs muizen gevoed
met HFD + IL.</li>
</ul>
</div>
<div id="power" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Power?</h3>
<p><span class="math display">\[
P[p &lt; \alpha \vert \beta_1 \neq 0]
\]</span></p>
<p>De kracht (power) zal dus afhangen van</p>
<ul>
<li>Het werkelijke gemiddelde gewichtsverschil <span
class="math inline">\(\beta_1\)</span> in de populatie.</li>
<li>De variabiliteit van de gewichtsmetingen</li>
<li>het significantie-niveau <span
class="math inline">\(\alpha\)</span></li>
<li>steekproefgrootte <span class="math inline">\(n_{IL}\)</span> en
<span class="math inline">\(n_c\)</span> in beide groepen</li>
</ul>
<p>We kunnen de power schatten als</p>
<ol style="list-style-type: decimal">
<li>voldaan is aan de aannamens van het model: gewicht in beide groepen
is normaal verdeeld met gelijke variantie</li>
</ol>
<p>en als we de</p>
<ol start="2" style="list-style-type: decimal">
<li><p>standaard deviatie kennen van gewichtsmetingen rond hun
groepsgemiddelde voor muizen die een HFD diet krijgen</p></li>
<li><p>de echte effectgrootte in de populatie</p></li>
<li><p><span class="math inline">\(n_1\)</span> en <span
class="math inline">\(n_2\)</span></p></li>
</ol>
</div>
<div
id="gebruik-data-uit-vorig-experiment-om-inzicht-te-krijgen-in-de-gewichtsdata-van-muizen"
class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Gebruik data uit
vorig experiment om inzicht te krijgen in de gewichtsdata van
muizen</h3>
<p>Stel dat we toegang hebben tot data van een vorig experiment (hier
dat van Karen Svenson en Dan Gatti, gefinancierd door P50 GM070683 en
beschikbaar op <a
href="http://genomicsclass.github.io/book/pages/random_variables.html">PH525x</a>)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mice <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/femaleMiceWeights.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>mice <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Diet,<span class="at">y=</span>Bodyweight)) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mice <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>Bodyweight)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet)</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mice <span class="ot">&lt;-</span> mice <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Diet =</span> <span class="fu">as.factor</span>(Diet))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>miceSum <span class="ot">&lt;-</span> mice <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)  <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="st">&quot;Bodyweight&quot;</span>,<span class="fu">list</span>(<span class="at">mean=</span><span class="sc">~</span><span class="fu">mean</span>(.,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd=</span><span class="sc">~</span><span class="fu">sd</span>(.,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n=</span><span class="cf">function</span>(x) x<span class="sc">%&gt;%</span>is.na<span class="sc">%&gt;%</span><span class="st">`</span><span class="at">!</span><span class="st">`</span><span class="sc">%&gt;%</span>sum)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>miceSum </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Diet"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"chow","2":"23.81333","3":"3.022541","4":"12","5":"0.8725323"},{"1":"hf","2":"26.83417","3":"4.097606","4":"12","5":"1.1828769"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In het experiment werden twee diëten gebruikt:</p>
<ul>
<li>gewoon diet o.b.v. granen (Chow)</li>
<li>Heel vet dieet (high fat: hf)</li>
</ul>
<p>We kunnen de data van de hf muizen gebruiken als input voor onze
power analyse.</p>
<ul>
<li>De data van hf muizen lijken normaal verdeeld te zijn.<br />
</li>
<li>Het gemiddelde gewicht van een hf muis is 26.8g</li>
<li>De standaard deviatie (SD) van het gewicht van hf muizen is
4.1g</li>
</ul>
<p>Effectgroote?</p>
<ul>
<li>De alternative hypothese is complex.</li>
<li>Omvat alle mogelijke effecten!</li>
<li>Om een power analyse te doen kiezen we daarom een minimale
effectgrootte die we wensen op te pikken in het nieuwe experiment.</li>
<li>Veronderstel dat we een gewichtsverschil willen oppikken van
minimaal 10%.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>mean[<span class="dv">2</span>] <span class="sc">*</span>.<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>delta</span></code></pre></div>
<pre><code>[1] -2.7</code></pre>
<p>Merk op dat het gemiddeld gewicht dan dicht komt bij dat van muizen
in het pilootexperiment die werden gevoed met het normale dieet.</p>
<p>We kunnen nu een simulatie studie opzetten om de power te berekenen
voor een experiment met 8 muizen in elke groep.</p>
<div id="eén-simulatie" class="section level4" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> Eén
simulatie</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1423</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>mean[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="sc">-</span> delta</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="fu">c</span>(n1,n2))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n1<span class="sc">+</span>n2,<span class="dv">0</span>, <span class="at">sd =</span> sd)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">&lt;-</span> fit<span class="sc">$</span>coef </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)<span class="sc">$</span>coef[<span class="dv">2</span>,]</span></code></pre></div>
<pre><code>  Estimate Std. Error    t value   Pr(&gt;|t|) 
 2.5972480  1.7919658  1.4493848  0.1692595 </code></pre>
<p>Voor het gesimuleerde experiment konden we het effect van de
behandeling niet oppikken bij het <span
class="math inline">\(\alpha\)</span>=0.05 (p = 0.17)
significantie-niveau!</p>
<ul>
<li>We moeten het experiment herhalen om de power te schatten.</li>
<li>We zullen de simulatie daarom coderen in een functie die we kunnen
hergebruiken.</li>
</ul>
</div>
<div id="simulatie-van-herhaalde-experimenten-repeated-experiments"
class="section level4" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> Simulatie van
herhaalde experimenten (repeated experiments)</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>mean[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="sc">-</span> delta</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>predictorData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="fu">c</span>(n1,n2)) <span class="sc">%&gt;%</span> as.factor)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>simLm <span class="ot">&lt;-</span> <span class="cf">function</span>(form, data, betas, sd, contrasts, <span class="at">simIndex =</span> <span class="cn">NA</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  dataSim <span class="ot">&lt;-</span> data</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form,dataSim)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  dataSim<span class="sc">$</span>ySim <span class="ot">&lt;-</span> X<span class="sc">%*%</span>betas <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dataSim),<span class="dv">0</span>,sd)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  form <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(<span class="st">&quot;ySim ~&quot;</span>,form[[<span class="dv">2</span>]]))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  fitSim <span class="ot">&lt;-</span> <span class="fu">lm</span>(form,dataSim)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  mcp <span class="ot">&lt;-</span> <span class="fu">glht</span>(fitSim,<span class="at">linfct =</span> contrasts)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">summary</span>(mcp)<span class="sc">$</span>test[<span class="fu">c</span>(<span class="st">&quot;coefficients&quot;</span>,<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;tstat&quot;</span>,<span class="st">&quot;pvalues&quot;</span>)]<span class="sc">%&gt;%</span> unlist)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">simLm</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">form =</span> <span class="sc">~</span>Diet,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> predictorData,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">betas =</span> <span class="fu">c</span>(b0,b1),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> sd,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>)</span></code></pre></div>
<pre><code>coefficients.Diethf        sigma.Diethf        tstat.Diethf             pvalues 
          1.9444623           2.0931302           0.9289734           0.3686439 </code></pre>
<p>We hebben nu een generiek functie waarmee we data kunnen simuleren
die normaal verdeeld zijn voor elk mogelijk design die we met het
lineair model kunnen analyseren.</p>
<p>De functie heeft volgende argumenten:</p>
<ul>
<li><code>form</code>: One sided formula including the structure of the
predictors in the model</li>
<li><code>data</code>: Data frame with the predictor values for the
design</li>
<li><code>betas</code>: A vector with values for all mean model
parameters</li>
<li><code>sd</code>: The standard deviation of the error</li>
<li><code>contrasts</code>: a scalar or a vector with the null
hypotheses that we would like to assess.</li>
<li><code>simIndex</code>: an arbitrary argument that is not used by the
function but that will allow it to be used in an sapply loop that runs
from 1 up to the number of simulations.</li>
</ul>
<p>Simuleer nSim = 1000 herhaalde experimenten:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1425</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>simResults  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nSim,simLm,<span class="at">form =</span> <span class="sc">~</span>Diet,<span class="at">data =</span> predictorData,<span class="at">betas =</span> <span class="fu">c</span>(b0,b1),<span class="at">sd =</span> sd,<span class="at">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">mean</span>(simResults[,<span class="dv">4</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div>
<pre><code>[1] 0.221</code></pre>
<p>We hebben een power van 22.1% om het behandelingseffect op te pikken
met 8 biologische herhalingen in elke behandelingsgroep.</p>
<p>Merk op dat de power van een experiment ook het hoogste is als het
aantal observaties gebalanceerd is, m.a.w. <span
class="math inline">\(n_1=n_2\)</span>.</p>
</div>
<div id="power-voor-verschillende-steekproefgroottes"
class="section level4" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> Power voor
verschillende steekproefgroottes</h4>
<p>We kunnen de power nu berekenen voor meerdere steekproefgrootes.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>),<span class="at">power=</span><span class="cn">NA</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(power))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> power<span class="sc">$</span>n[i]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  predictorData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="fu">c</span>(n1,n2)) <span class="sc">%&gt;%</span> as.factor)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  simResults  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nSim,simLm,<span class="at">form =</span> <span class="sc">~</span>Diet,<span class="at">data =</span> predictorData,<span class="at">betas =</span> <span class="fu">c</span>(b0,b1),<span class="at">sd =</span> sd,<span class="at">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  power<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(simResults[,<span class="st">&quot;pvalues&quot;</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["power"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"0.114"},{"1":"5","2":"0.158"},{"1":"10","2":"0.304"},{"1":"25","2":"0.648"},{"1":"50","2":"0.890"},{"1":"75","2":"0.982"},{"1":"100","2":"0.998"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>power <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>power)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div
id="bestudeer-power-in-functie-van-steekproefgrootte-en-effectgrootte"
class="section level4" number="3.4.3.4">
<h4><span class="header-section-number">3.4.3.4</span> Bestudeer power
in functie van steekproefgrootte en effectgrootte</h4>
<p>Merk op dat</p>
<ul>
<li>het teken van delta arbitrair is omdat we tweezijdig testen.</li>
<li>het intercept arbitrair is omdat we alleen testen op <span
class="math inline">\(\beta_1\)</span></li>
<li>We nemen daarom typisch <span class="math inline">\(\beta_0 =
0\)</span></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>deltas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">b1=</span><span class="fu">rep</span>(deltas,<span class="at">each=</span><span class="fu">length</span>(ns)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n=</span><span class="fu">rep</span>(ns,<span class="fu">length</span>(deltas)),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">power=</span><span class="cn">NA</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(power))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span>power<span class="sc">$</span>b1[i]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span>  power<span class="sc">$</span>n[i]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  predictorData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="fu">c</span>(n1,n2)) <span class="sc">%&gt;%</span> as.factor)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  simResults  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nSim,simLm,<span class="at">form =</span> <span class="sc">~</span>Diet,<span class="at">data =</span> predictorData,<span class="at">betas =</span> <span class="fu">c</span>(b0,b1),<span class="at">sd =</span> sd,<span class="at">contrasts =</span> <span class="st">&quot;Diethf = 0&quot;</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  power<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(simResults[,<span class="st">&quot;pvalues&quot;</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>power <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>power,<span class="at">col=</span>b1<span class="sc">%&gt;%</span>as.factor)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Merk op dat de power curves wat schokkerig zijn omdat we maar een
beperkt aantal steekproefgroottes en een beperkt aantal simulaties
uitvoerden. Voor de lage powers is het aantal simulaties zeker
onvoldoende om heel betrouwbare schattingen van de power te bekomen.</p>
</div>
</div>
</div>
</div>
<div id="opmerkingen" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Opmerkingen</h1>
<ul>
<li><p>De code kan eenvoudig aangepast worden naar andere designs (zie
oefeningen)</p>
<ul>
<li>predictor data</li>
<li>formula</li>
<li>contrast</li>
</ul></li>
<li><p>De simulaties kunnen lang duren wanneer je veel scenario’s
evalueert.</p>
<ul>
<li>Meer efficiënte code met matrices</li>
<li>Voor two group comparison bestaat een analytische oplossing.</li>
</ul></li>
</ul>
<div id="meer-efficiënte-code-met-matrices" class="section level2"
number="4.1">
<h2><span class="header-section-number">4.1</span> Meer efficiënte code
met matrices</h2>
<p>Code is veel sneller. We simulaleren nu 20 keer meer experimenten in
een veel kortere tijd!</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>deltas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>powerFast <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span><span class="fu">length</span>(ns)<span class="sc">*</span><span class="fu">length</span>(deltas),<span class="at">ncol=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(powerFast) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;b1&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;power&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> ns)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span>  n</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Simulation</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  predictorData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="st">&quot;hf&quot;</span>),<span class="fu">c</span>(n1,n2)) <span class="sc">%&gt;%</span> as.factor)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Diet,predictorData)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> limma<span class="sc">::</span><span class="fu">makeContrasts</span>(<span class="st">&quot;Diethf&quot;</span>,<span class="at">levels =</span> <span class="fu">colnames</span>(design))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (b1 <span class="cf">in</span> deltas)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    ySim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(predictorData)<span class="sc">*</span>nSim,<span class="at">sd=</span>sd)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(ySim) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">nrow</span>(predictorData),nSim)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    ySim <span class="ot">&lt;-</span> ySim <span class="sc">+</span> <span class="fu">c</span>(design <span class="sc">%*%</span><span class="fu">c</span>(b0,b1))</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    ySim <span class="ot">&lt;-</span> <span class="fu">t</span>(ySim)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Fitting</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    fitAll <span class="ot">&lt;-</span> limma<span class="sc">::</span><span class="fu">lmFit</span>(ySim,design)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Inference</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    varUnscaled <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">t</span>(L)<span class="sc">%*%</span>fitAll<span class="sc">$</span>cov.coefficients<span class="sc">%*%</span>L)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    contrasts <span class="ot">&lt;-</span> fitAll<span class="sc">$</span>coefficients <span class="sc">%*%</span>L</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    seContrasts <span class="ot">&lt;-</span> varUnscaled<span class="sc">^</span>.<span class="dv">5</span><span class="sc">*</span>fitAll<span class="sc">$</span>sigma</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    tstats <span class="ot">&lt;-</span> contrasts<span class="sc">/</span>seContrasts</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    pvals <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(tstats),fitAll<span class="sc">$</span>df.residual,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    powerFast[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(b1,n,<span class="fu">mean</span>(pvals <span class="sc">&lt;</span> alpha))</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>powerFast <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>power,<span class="at">col=</span>b1<span class="sc">%&gt;%</span>as.factor)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div
id="meer-efficiënte-code-gebaseerd-op-de-analytische-oplossing-voor-een-two-group-comparison"
class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Meer efficiënte code
gebaseerd op de analytische oplossing voor een two group comparison</h2>
<ul>
<li><p>Voor de two sample t-test bestaat er een analytische oplossing om
de power te berekenen.</p></li>
<li><p>In deze context maakt men typisch gebruik van de “Cohen’s effect
size”:</p></li>
</ul>
<p><span class="math inline">\(D = \frac{\delta}{SD}\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">delta =</span> delta, <span class="at">sd =</span> sd, <span class="at">type=</span><span class="st">&#39;two.sample&#39;</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 8
          delta = 2.7
             sd = 4.1
      sig.level = 0.05
          power = 0.2320512
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<p>Merk op dat de power overeenkomt met degene die we via simulaties
hebben geschat!</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">round</span>(miceSum<span class="sc">$</span>sd[<span class="dv">2</span>],<span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>deltas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>powerTheo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">deltas=</span><span class="fu">rep</span>(deltas,<span class="at">each=</span><span class="fu">length</span>(ns)),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n=</span><span class="fu">rep</span>(ns,<span class="fu">length</span>(deltas)),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">power=</span><span class="cn">NA</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>powerTheo<span class="sc">$</span>power <span class="ot">&lt;-</span> <span class="fu">apply</span>(powerTheo[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">power.t.test</span>(<span class="at">delta=</span>x[<span class="dv">1</span>],<span class="at">n=</span>x[<span class="dv">2</span>],<span class="at">sd=</span>sd,<span class="at">type=</span><span class="st">&quot;two.sample&quot;</span>)<span class="sc">$</span>power)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>powerTheo <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>power,<span class="at">col=</span>deltas<span class="sc">%&gt;%</span>as.factor)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="experimentalDesignI_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhwZXJpbWVudGVlbCBEZXNpZ24gSTogcmVwbGljYXRpZSBlbiBwb3dlciIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgbnVtYmVyX3NlY3Rpb25zOiB5ZXMKLS0tCgoKPGEgcmVsPSJsaWNlbnNlIiBocmVmPSJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktbmMtc2EvNC4wIj48aW1nIGFsdD0iQ3JlYXRpdmUgQ29tbW9ucyBMaWNlbnNlIiBzdHlsZT0iYm9yZGVyLXdpZHRoOjAiIHNyYz0iaHR0cHM6Ly9pLmNyZWF0aXZlY29tbW9ucy5vcmcvbC9ieS1uYy1zYS80LjAvODh4MzEucG5nIiAvPjwvYT4KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoaW5jbHVkZSA9IFRSVUUsIGNvbW1lbnQgPSBOQSwgZWNobyA9IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRSkKbGlicmFyeSh0aWR5dmVyc2UpCmBgYAoKCmBgYHtyIHBvcDJTYW1wMlBvcCxmaWcuYXNwPS44LCBmaWcuYWxpZ249J2NlbnRlcicsZWNobz1GQUxTRX0KaWYgKCJwaSIlaW4lbHMoKSkgcm0oInBpIikKa29wdm9ldGVyPC1mdW5jdGlvbih4LHksYW5nbGU9MCxsPS4yLGNleC5kb3Q9LjUscGNoPTE5LGNvbD0iYmxhY2siKQp7CmFuZ2xlPWFuZ2xlLzE4MCpwaQpwb2ludHMoeCx5LGNleD1jZXguZG90LHBjaD1wY2gsY29sPWNvbCkKbGluZXMoYyh4LHgrbCpjb3MoLXBpLzIrYW5nbGUpKSxjKHkseStsKnNpbigtcGkvMithbmdsZSkpLGNvbD1jb2wpCmxpbmVzKGMoeCtsLzIqY29zKC1waS8yK2FuZ2xlKSx4K2wvMipjb3MoLXBpLzIrYW5nbGUpK2wvNCpjb3MoYW5nbGUpKSxjKHkrbC8yKnNpbigtcGkvMithbmdsZSkseStsLzIqc2luKC1waS8yK2FuZ2xlKStsLzQqc2luKGFuZ2xlKSksY29sPWNvbCkKbGluZXMoYyh4K2wvMipjb3MoLXBpLzIrYW5nbGUpLHgrbC8yKmNvcygtcGkvMithbmdsZSkrbC80KmNvcyhwaSthbmdsZSkpLGMoeStsLzIqc2luKC1waS8yK2FuZ2xlKSx5K2wvMipzaW4oLXBpLzIrYW5nbGUpK2wvNCpzaW4ocGkrYW5nbGUpKSxjb2w9Y29sKQpsaW5lcyhjKHgrbCpjb3MoLXBpLzIrYW5nbGUpLHgrbCpjb3MoLXBpLzIrYW5nbGUpK2wvMipjb3MoLXBpLzIrcGkvNCthbmdsZSkpLGMoeStsKnNpbigtcGkvMithbmdsZSkseStsKnNpbigtcGkvMithbmdsZSkrbC8yKnNpbigtcGkvMitwaS80K2FuZ2xlKSksY29sPWNvbCkKbGluZXMoYyh4K2wqY29zKC1waS8yK2FuZ2xlKSx4K2wqY29zKC1waS8yK2FuZ2xlKStsLzIqY29zKC1waS8yLXBpLzQrYW5nbGUpKSxjKHkrbCpzaW4oLXBpLzIrYW5nbGUpLHkrbCpzaW4oLXBpLzIrYW5nbGUpK2wvMipzaW4oLXBpLzItcGkvNCthbmdsZSkpLGNvbD1jb2wpCn0KCnBhcihtYXI9YygwLDAsMCwwKSxtYWk9YygwLDAsMCwwKSkKcGxvdCgwLDAseGxhYj0iIix5bGFiPSIiLHhsaW09YygwLDEwKSx5bGltPWMoMCwxMCksY29sPTAseGF4dD0ibm9uZSIseWF4dD0ibm9uZSIsYXhlcz1GQUxTRSkKcmVjdCgwLDYsMTAsMTAsYm9yZGVyPSJyZWQiLGx3ZD0yKQp0ZXh0KC41LDgsInBvcHVsYXRpZSIsc3J0PTkwLGNvbD0icmVkIixjZXg9MikKc3ltYm9scyAoMywgOCwgY2lyY2xlcz0xLjUsIGNvbD0icmVkIixhZGQ9VFJVRSxmZz0icmVkIixpbmNoZXM9RkFMU0UsbHdkPTIpCmdyaWQ9c2VxKDAsMS4zLC4wMSkKCmZvciAoaSBpbiAxOjUwKQp7CglhbmdsZTE9cnVuaWYobj0xLG1pbj0wLG1heD0zNjApCglhbmdsZTI9cnVuaWYobj0xLG1pbj0wLG1heD0zNjApCglyYWRpdXM9c2FtcGxlKGdyaWQscHJvYj1ncmlkXjIqcGkvc3VtKGdyaWReMipwaSksc2l6ZT0xKQoJa29wdm9ldGVyKDMrcmFkaXVzKmNvcyhhbmdsZTEvMTgwKnBpKSw4K3JhZGl1cypzaW4oYW5nbGUxLzE4MCpwaSksYW5nbGU9YW5nbGUyKQp9CnRleHQoNy41LDgsIkVmZmVjdCB2YW4gcm9rZW4gaW4gcG9wdWxhdGllIixjb2w9InJlZCIsY2V4PTEuMikKCnJlY3QoMCwwLDEwLDQsYm9yZGVyPSJibHVlIixsd2Q9MikKdGV4dCguNSwyLCJzYW1wbGUiLHNydD05MCxjb2w9ImJsdWUiLGNleD0yKQpzeW1ib2xzICgzLCAyLCBjaXJjbGVzPTEuNSwgY29sPSJyZWQiLGFkZD1UUlVFLGZnPSJibHVlIixpbmNoZXM9RkFMU0UsbHdkPTIpCmZvciAoaSBpbiAwOjIpCglmb3IgKGogaW4gMDo0KQp7CgoJa29wdm9ldGVyKDIuMStqKigzLjktMi4xKS80LDEuMStpKQp9CnRleHQoNy41LDIsIkVmZmVjdCB2YW4gcm9rZW4gaW4gc3RlZWtwcm9lZiIsY29sPSJibHVlIixjZXg9MS4yKQoKYXJyb3dzKDMsNS45LDMsNC4xLGNvbD0iYmxhY2siLGx3ZD0zKQphcnJvd3MoNyw0LjEsNyw1LjksY29sPSJibGFjayIsbHdkPTMpCnRleHQoMS41LDUsIkVYUC4gREVTSUdOICgxKSIsY29sPSJibGFjayIsY2V4PTEuMikKdGV4dCg4LjUsNSwiU0NIQVRURU4gJlxuSU5GRVJFTlRJRSAoMykiLGNvbD0iYmxhY2siLGNleD0xLjIpCnRleHQoNy41LC41LCJEQVRBIEVYUExPUkFUSUUgJlxuQkVTQ0hSSUpWRU5ERSBTVEFUSVNUSUVLICgyKSIsY29sPSJibGFjayIsY2V4PTEuMikKYGBgCgoKIyBDb25jZXB0ZW4KCi0gRXhwZXJpbWVudGVsZSBlZW5oZWRlbiB6aWpuIHN1YmplY3RlbiwgcGxhbnRlbiwgcHJvZWZkaWVyZW4gb2Ygb2JqZWN0ZW4gZGllIGFhbiBiZWhhbmRlbGluZ2VuIHdvcmRlbiBvbmRlcndvcnBlbiBpbiBlZW4gZXhwZXJpbWVudGVsZSBzdHVkaWUuIAotIE9ic2VydmF0aW9uZWxlIGVlbmhlZGVuIHppam4gZGUgc3ViamVjdGVuLCBwbGFudGVuIHByb2VmZGllcmVuIG9mIG9iamVjdGVuIHdhYXJvcCB3ZSBtZXRpbmdlbiBkb2VuLiBNZWVzdGFsIHppam4gZGUgZXhwZXJpbWVudGVsZSBlbiBvYnNlcnZhdGlvbmVsZSBlZW5oZWRlbiBoZXR6ZWxmZGUuIEFscyBkYXQgbmlldCBoZXQgZ2V2YWwgaXMgaGVlZnQgbWV0IHZhYWsgcHNldWRvcmVwbGljYXRpZS4gCi0gRXhwZXJpbWVudGVsZSBlZW5oZWRlbiByZXByZXNlbnRhdGllZiB2b29yIHBvcHVsYXRpZTogUmFuZG9taXNhdGllCi0gUmVwbGljYXRpZTogdGVjaG5pc2NoIHZzIGJpb2xvZ2lzY2gsIHN0ZWVrcHJvZWZncm9vdHRlIC0gcG93ZXIKLSBCcm9ubmVuIHZhbiB2YXJpYWJpbGl0ZWl0OiB0ZWNobmlzY2gsIGJpb2xvZ2lzY2gsIGJpbm5lbiBlbiB0dXNzZW4gc3ViamVjdGVuLiAKCiMgUmVwbGljYXRpZSAKClBhcGVyIG92ZXIgcmVwbGljYXRpZSBpbiBOYXR1cmUgTWV0aG9kcyAoMiBwYWdpbmEncykgW1tQREZdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvbm1ldGguMzA5MS5wZGYpXQohW10oaHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9ubWV0aC4zMDkxLnBkZil7IHdpZHRoPTEwMCUgfQoKIyMgVm9vcmJlZWxkCgpJbiBlZW4gUk5BLXNlcSBleHBlcmltZW50IHdpbGxlbiBkZSBvbmRlcnpvZWtlcnMgaGV0IGVmZmVjdCBuYWdhYW4gdmFuIGVlbiBtZWRpY2lqbiBvcCBkZSBnZW4gZXhwcmVzc2llLiAKCk1vZ2VsaWprc2Ugb25kZXJ6b2Vrc3ZyYWFnCgotIElzIGVyIGVlbiB2ZXJzY2hpbCBpbiBnZW1pZGRlbGRlIGdlbiBleHByZXNzaWUgdHVzc2VuIGJlaGFuZGVsZGUgZW4gbmlldCBiZWhhbmRlbGRlIHNhbXBsZXMKCiMjIEJyb25uZW4gdmFuIHZhcmlhYmlsaXRlaXQKClRBQkxFIDEgTkFUVVJFIE1FVEhPRFMgfCBWT0wuMTEgTk8uOSB8IFNFUFRFTUJFUiAyMDE0IHwgODc5IC0gODgwCgp8ICAgfCBSZXBsaWNhdGUgdHlwZSB8IFJlcGxpY2F0ZSBjYXRlZ29yeSReXHRleHR7YX0kIHwKfDotLS06fDotLS18Oi0tLTp8CnwgfCBDb2xvbmllcyB8CUIgfAp8IHwgU3RyYWlucyB8CUIgfAp8IEFuaW1hbCBzdHVkeSBzdWJqZWN0cyB8IENvaG91c2VkIGdyb3VwcyB8CUIgfAp8IHwgR2VuZGVyIHwgQiB8CnwgfCBJbmRpdmlkdWFscwl8IEIgfCAKfCB8IHwgfAp8IHwgT3JnYW5zIGZyb20gc2FjcmlmaWNlZCBhbmltYWxzIHwgQiB8CnwgfCBNZXRob2RzIGZvciBkaXNzb2NpYXRpbmcgY2VsbHMgZnJvbSB0aXNzdWUgfCBUIHwKfCBTYW1wbGUgcHJlcGFyYXRpb24gfCBEaXNzb2NpYXRpb24gcnVucyBmcm9tIGdpdmVuIHRpc3N1ZSBzYW1wbGUgfCBUIHwKfCB8IEluZGl2aWR1YWwgY2VsbHMgfCBCIHwKfCB8IHwgfAp8IHwgUk5BLXNlcSBsaWJyYXJ5IGNvbnN0cnVjdGlvbiB8IFQgfAp8IHwgUnVucyBmcm9tIHRoZSBsaWJyYXJ5IG9mIGEgZ2l2ZW4gY2VsbCB8CVQgfAp8IFNlcXVlbmNpbmcgfCBSZWFkcyBmcm9tIGRpZmZlcmVudCB0cmFuc2NyaXB0IG1vbGVjdWxlcyB8IFYkXlx0ZXh0e2J9JCB8CnwgfCBSZWFkcyB3aXRoIHVuaXF1ZSBtb2xlY3VsYXIgaWRlbnRpZmllciAoVU1JKSBmcm9tIGEgZ2l2ZW4gdHJhbnNjcmlwdCBtb2xlY3VsZSB8CVQgfAoKKGEpIFJlcGxpY2F0ZXMgYXJlIGNhdGVnb3JpemVkIGFzIGJpb2xvZ2ljYWwgKEIpLCB0ZWNobmljYWwgKFQpIG9yIG9mIHZhcmlhYmxlIHR5cGUgKFYpLiAKKGIpIFNlcXVlbmNlIHJlYWRzIHNlcnZlIGRpdmVyc2UgcHVycG9zZXMgZGVwZW5kaW5nIG9uIHRoZSBhcHBsaWNhdGlvbiBhbmQgaG93IHJlYWRzIGFyZSB1c2VkIGluIGFuYWx5c2lzLgoKLS0tCgojIyBPcCB3ZWxrIG5pdmVhdSBtb2V0ZW4gd2UgcmVwbGljZXJlbj8KCi0gJFx0ZXh0e3Zhcn0oWCk9XHNpZ21hXjJfQStcc2lnbWFeMl9DK1xzaWdtYV4yX009XHNpZ21hXjJfe1RPVH0kCi0gJFx0ZXh0e3Zhcn0oXGJhcntYfSk9XGZyYWN7XHNpZ21hXjJfQX17bl9BfStcZnJhY3tcc2lnbWFeMl9DfXtuX0Egbl9DfSArIFxmcmFje1xzaWdtYV4yX019e25fQSBuX0Mgbl9NfSQKCiFbXShodHRwczovL21lZGlhLnNwcmluZ2VybmF0dXJlLmNvbS9mdWxsL3NwcmluZ2VyLXN0YXRpYy9pbWFnZS9hcnQlM0ExMC4xMDM4JTJGbm1ldGguMzA5MS9NZWRpYU9iamVjdHMvNDE1OTJfMjAxNF9BcnRpY2xlX0JGbm1ldGgzMDkxX0ZpZzFfSFRNTC5qcGcpCkZpZ3VyZSAxIE5BVFVSRSBNRVRIT0RTIHwgVk9MLjExIE5PLjkgfCBTRVBURU1CRVIgMjAxNCB8IDg3OSAtIDg4MAoKKGEpIFRocmVlIGxldmVscyBvZiByZXBsaWNhdGlvbiAodHdvIGJpb2xvZ2ljYWwsIG9uZSB0ZWNobmljYWwpIHdpdGggYW5pbWFsLCBjZWxsIGFuZCBtZWFzdXJlbWVudCByZXBsaWNhdGVzIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIHdpdGggYSBtZWFuIGFjcm9zcyBhbmltYWxzIG9mIDEwIGFuZCByYXRpbyBvZiB2YXJpYW5jZXMgMToyOjAuNS4gU29saWQgZ3JlZW4gKGJpb2xvZ2ljYWwpIGFuZCBibHVlICh0ZWNobmljYWwpIGRvdHMgc2hvdyBob3cgYSBtZWFzdXJlbWVudCBvZiB0aGUgZXhwcmVzc2lvbiAoWCA9IDEyKSBzYW1wbGVzIGZyb20gYWxsIHRocmVlIHNvdXJjZXMgb2YgdmFyaWF0aW9uLiBEaXN0cmlidXRpb24gcy5kLiBpcyBzaG93biBhcyBob3Jpem9udGFsIGxpbmVzLiAKKGIpIEV4cHJlc3Npb24gdmFyaWFuY2UsIFZhcihYKSwgYW5kIHZhcmlhbmNlIG9mIGV4cHJlc3Npb24gbWVhbiwgVmFyKCRcYmFyIFgkKSwgY29tcHV0ZWQgYWNyb3NzIDEwLDAwMCBzaW11bGF0aW9ucyBvZiBuQW5Dbk0gPSA0OCBtZWFzdXJlbWVudHMgZm9yIHVuaXF1ZSBjb21iaW5hdGlvbnMgb2YgdGhlIG51bWJlciBvZiBhbmltYWxzIChuQSA9IDEgdG8gNDgpLCBjZWxscyBwZXIgYW5pbWFsIChuQyA9IDEgdG8gNDgpIGFuZCB0ZWNobmljYWwgcmVwbGljYXRlIG1lYXN1cmVtZW50cyBwZXIgY2VsbCAobk0gPSAxIGFuZCAzKS4gVGhlIHJhdGlvIG9mIFZhcihYKSBhbmQgVmFyKCRcYmFyIFgkKSBpcyB0aGUgZWZmZWN0aXZlIHNhbXBsZSBzaXplLCBuLCB3aGljaCBjb3JyZXNwb25kcyB0byB0aGUgZXF1aXZhbGVudCBudW1iZXIgb2Ygc3RhdGlzdGljYWxseSBpbmRlcGVuZGVudCBtZWFzdXJlbWVudHMuIEhvcml6b250YWwgZGFzaGVkIGxpbmVzIGNvcnJlc3BvbmQgdG8gYmlvbG9naWNhbCBhbmQgdG90YWwgdmFyaWF0aW9uLiBFcnJvciBiYXJzIG9uIFZhcihYKSBzaG93IHMuZC4gZnJvbSB0aGUgMTAsMDAwIHNpbXVsYXRlZCBzYW1wbGVzIChuTSA9IDEpLgoKLS0tCgpXYWFyIGxpZ3QgaW50ZXJlc3NlPyAKCi0gS2FyYWt0ZXJpc2VyZW4gdmFuIGJyb25uZW4gdmFuIHZhcmlhYmlsaXRlaXQgaW4gZXhwZXJpbWVudCA9PT4gdGVjaG5pc2NoZSBlbiBiaW9sb2dpc2NoZSByZXBlYXRzIHppam4gbm9kaWcKLSBWb29ybmFtZWxpamtlIGludGVyZXNzZSBpbiBzY2hhdHRlbiB2YW4gZWZmZWN0IHZhbiBiZWhhbmRlbGluZyA9PT4gZm9jdXMgb3AgYmlvbG9naXNjaGUgcmVwZWF0cwotIEV4dHJhIGJpb2xvZ2lzY2hlIHJlcGVhdHMgbHVtcGVuIGFsbGUgYnJvbm5lbiB2YW4gdmFyaWFiaWxpdGVpdDogYmlvbG9naXNjaGUgKyB0ZWNobmlzY2hlIHZhcmlhYmlsaXRlaXQuIAoKLSBHb2VkIGV4cGVyaW1lbnRlZWwgZGVzaWduIHZlcmVpc3QgbmEgZGVua2VuIG92ZXIgcmVwbGljYXRpZSAKCiAgMS4gSWRlbnRpZmljZWVyIG9uZGVyem9la3N2cmFnZW4gZGllIG1lbiB3ZW5zdCB0ZSBiZWFudHdvb3JkZW4uIAogIDIuIEJyZW5nIGJyb25uZW4gdmFuIHZhcmlhYmlsaXRlaXQgaW4ga2FhcnQgaW4gZWxrZSBzdGFwIHZhbiBoZXQgZXhwZXJpbWVudAogIDMuIExldCBvcCB2b29yIHBzZXVkb3JlcGxpY2F0aWUsIGJlb29nIHpvdmVlbCBtb2dlbGlqayBvbmFmaGFua2VsaWprZSByZXBlYXRzLiAKCi0tLSAKCiMgUG93ZXIsIHN0ZWVrcHJvZWZncm9vdHRlIGVuIGFuZGVyZSBkZXNpZ24gYXNwZWN0ZW4uIAoKUmVhZGluZyBtYXRlcmlhbHM6IApbTmF0dXJlIE1ldGhvZHMgKDIwMTMpLCAxMCgxMiksIDExMznigJMxMTQwXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25tZXRoLjI3MzgucGRmKQoKIyMgSW50ZXJtZXp6byBsaW5lYXJlIHJlZ3Jlc3Npb24gaW4gbWF0cml4IHZvcm0gCgotIExpbmVhaXJlIHJlZ3Jlc3NpZSBpcyBlZW4gYmVsYW5ncmlqa2UgbWV0aG9kZSBpbiBzdGF0aXN0aXNjaGUgZGF0YSBhbmFseXNlLgoKIyMjIFNjYWxhaXJlIHZvcm0KCi0gU3RlbCBkYXQgbWVuIHZvb3IgZWxrZSBleHBlcmltZW50ZWxlIGVlbmhlaWQgJHAkIHByZWRpY3RvcmVuIG1lZXQgJFxtYXRoYmZ7eH09KHhfMSxcbGRvdHMseF9wKSQgZW4KLSBjb250aW51ZSByZXNwb25zICRZJAotIGhldCBsaW5lYXIgcmVncmVzc2llbW9kZWwga2FuIGRhbiB3b3JkZW4gZ2VzY2hyZXZlbiBhbHM6IApcWwpZPWYoXG1hdGhiZnt4fSkgK1xlcHNpbG9uPVxiZXRhXzArXHN1bVxsaW1pdHNfe2o9MX1ecCB4X2pcYmV0YV9qICsgXGVwc2lsb24KXF0KbWV0IGkuaS5kLiAkXGVwc2lsb25cc2ltIE4oMCxcc2lnbWFeMikkCgoKCiMjIyBWZWN0b3IvTWF0cml4IHZvcm0KCi0gJG4kIG9ic2VydmF0aWUgJChcbWF0aGJme3h9XzEseV8xKSBcbGRvdHMgKFxtYXRoYmZ7eH1fbix5X24pJCB3aXRoICRcbWF0aGJme3h9XzFeVD1bMSB4XzEgXGxkb3RzIHhfcF0kCi0gUmVncmVzc2llIGluIG1hdHJpeCBub3RhdGllClxbXG1hdGhiZntZfT1cbWF0aGJme1hcYmV0YX0gKyBcbWF0aGJme1xlcHNpbG9ufVxdCm1ldCAkXG1hdGhiZntZfT1cbGVmdFtcYmVnaW57YXJyYXl9e2N9eV8xXFwgXHZkb3RzXFx5X25cZW5ke2FycmF5fVxyaWdodF0kLAokXG1hdGhiZntYfT1cbGVmdFtcYmVnaW57YXJyYXl9e2NjY2N9IDEmeF97MTF9JlxsZG90cyZ4X3sxcH1cXApcdmRvdHMmXHZkb3RzJiZcdmRvdHNcXAoxJnhfe24xfSZcbGRvdHMmeF97bnB9ClxlbmR7YXJyYXl9XHJpZ2h0XSQgb3IgJFxtYXRoYmZ7WH09XGxlZnRbXGJlZ2lue2FycmF5fXtjfSBcbWF0aGJme3h9XzFeVFxcXHZkb3RzXFxcbWF0aGJme3h9X25eVFxlbmR7YXJyYXl9XHJpZ2h0XSQsCiRcYm9sZHN5bWJvbHtcYmV0YX09XGxlZnRbXGJlZ2lue2FycmF5fXtjfVxiZXRhXzBcXCBcdmRvdHNcXCBcYmV0YV9wXGVuZHthcnJheX1ccmlnaHRdJCBhbmQKJFxtYXRoYmZ7XGVwc2lsb259PVxsZWZ0W1xiZWdpbnthcnJheX17Y30gXGVwc2lsb25fMSBcXCBcdmRvdHMgXFwgXGVwc2lsb25fblxlbmR7YXJyYXl9XHJpZ2h0XSQKCi0tLQoKIyMga2xlaW5zdGUga3dhZHJhdGVuIHRlY2huaWVrL0xlYXN0IFNxdWFyZXMgKExTKQoKLSBNaW5pbWltYWxpc2VlciBkZSAgcmVzaWR1ZWxlIGt3YWRyYXRlbnNvbQpcYmVnaW57ZXFuYXJyYXkqfQpSU1MoXGJvbGRzeW1ib2x7XGJldGF9KSY9JlxzdW1cbGltaXRzX3tpPTF9Xm4gZV4yX2lcXAomPSZcc3VtXGxpbWl0c197aT0xfV5uIFxsZWZ0KHlfaS1cYmV0YV8wLVxzdW1cbGltaXRzX3tqPTF9XnAgeF97aWp9XGJldGFfalxyaWdodCleMgpcZW5ke2VxbmFycmF5Kn0KCi0gb2YgaW4gbWF0cml4IG5vdGF0aWUKCiQkClx0ZXh0e1JTU30oXGJvbGRzeW1ib2x7XGJldGF9KT0oXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pXlQoXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pCiQkCgokJFxyaWdodGFycm93IFxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fT1cdGV4dHthcmdtaW59X1xiZXRhIFx0ZXh0eyBSU1N9KFxib2xkc3ltYm9se1xiZXRhfSkkJAoKLS0tCgojIyMgTWluaW1pbWFsaXNlZXIgUlNTClxbClxiZWdpbnthcnJheX17Y2NjfQpcZnJhY3tccGFydGlhbCBSU1N9e1xwYXJ0aWFsIFxib2xkc3ltYm9se1xiZXRhfX0mPSZcbWF0aGJmezB9XFxcXApcZnJhY3soXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pXlQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9KX17XHBhcnRpYWwgXGJvbGRzeW1ib2x7XGJldGF9fSY9JlxtYXRoYmZ7MH1cXFxcCi0yXG1hdGhiZntYfV5UKFxtYXRoYmZ7WX0tXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfSkmPSZcbWF0aGJmezB9XFxcXApcbWF0aGJme1h9XlRcbWF0aGJme1hcYmV0YX0mPSZcbWF0aGJme1h9XlRcbWF0aGJme1l9XFxcXApcaGF0e1xib2xkc3ltYm9se1xiZXRhfX0mPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7WX0KXGVuZHthcnJheX0KXF0KCi0tLQoKIyMgVmFyaWFudGllIHNjaGF0dGVyPwpcWwpcYmVnaW57YXJyYXl9e2NjbH0KXGhhdHtcYm9sZHN5bWJvbHtcU2lnbWF9fV97XGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19fQomPSZcdGV4dHt2YXJ9XGxlZnRbKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme1l9XHJpZ2h0XVxcXFwKJj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcdGV4dHt2YXJ9XGxlZnRbXG1hdGhiZntZfVxyaWdodF1cbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cXFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UKFxtYXRoYmZ7SX1cc2lnbWFeMilcbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX0KXFxcXAomPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7SX1ccXVhZFxtYXRoYmZ7WH0oXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxzaWdtYV4yXFxcXAolXGhhdHtcYm9sZG1hdGh7XFNpZ21hfX1fe1xoYXR7XGJvbGRzeW1ib2x7XGJldGF9fX0mPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFx0ZXh0e3Zhcn1cbGVmdFtcbWF0aGJme1l9XHJpZ2h0XShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfVxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXG1hdGhiZntYfShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XHNpZ21hXjJcXFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XHNpZ21hXjIKXGVuZHthcnJheX0KXF0KCkRlIG9uemVrZXJoZWlkIG9wIG1vZGVsIHBhcmFtZXRlcnMgaGFuZ3QgZHVzIGFmIHZhbiBkZSByZXNpZHVlbGUgdmFyaWFiaWxpdGVpdCBlbiBoZXQgZGUgcHJvZWZvcHpldCEKCi0gSG9lIGdyb3RlciAkXG1hdGhiZntYfV5UXG1hdGhiZntYfSQgaG9lIG1lZXIgaW5mb3JtYXRpZSBoZXQgZXhwZXJpbWVudCB6YWwgaGViYmVuIG92ZXIgZGUgbW9kZWwgcGFyYW1ldGVycyBlbiBob2Uga2xlaW5lciBodW4gdmFyaWFudGllIGVuIHN0YW5kYWFyZCBlcnJvcnMhIAoKLSBGYWN0b3Jpw6tsZSBkZXNpZ25zPyAKLSBEZXNpZ25zIHdpdGggY29udGludWUgcHJlZGljdG9yZW4/IAoKLS0tCgpEZSBlZmZlY3Rncm9vdHRlIHZhbiBpbnRlcmVzc2UgaXMgdHlwaXNjaCBlZW4gbGluZWFpcmUgY29tYmluYXRpZSB2YW4gZGUgbW9kZWwgcGFyYW1ldGVycywgIAokJApsXzAgXHRpbWVzIFxiZXRhXzAgKyBsXzEgXHRpbWVzIFxiZXRhXzEgKyAuLi4gKyBsX3twLTF9IFx0aW1lcyBcYmV0YV97cC0xfSA9IFxtYXRoYmZ7TH1eVFxib2xkc3ltYm9se1xiZXRhfQokJCAKCkRlIG51bGh5cG90aGVzZSB2YW4gb256ZSB0ZXN0IGthbiBkYW4gd29yZGVuIGdlc2NocmV2ZW4gYWxzIAoKCiQkCkhfMDogXG1hdGhiZntMfV5UXGJvbGRzeW1ib2x7XGJldGF9ID0gMCAKJCQgCgp2cyBkZSBhbHRlcm5hdGlldmUgaHlwb3RoZXNlIAoKJCQKSF8xOiBcbWF0aGJme0x9XlRcYm9sZHN5bWJvbHtcYmV0YX0gXG5lcSAwIAokJAoKRW4gaGV0IGJld2lqcyBpbiBoZXQgZXhwZXJpbWVudCB0ZWdlbiAkSF8wJCBrYW4gd29yZGVuIGdla3dhbnRpZmljZWVyZCBtZXQgZGUgdC10ZXN0IHN0YXRpc3RpZWs6IAoKJCQKdD1cZnJhY3tcbWF0aGJme0x9XlRcaGF0e1xib2xkc3ltYm9se1xiZXRhfX0gLSAwfXtcdGV4dHtzZX1fe1xtYXRoYmZ7TH1eVFxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fX19CiQkCmRpZSBlZW4gdC1kaXN0cmlidXRpZSB2b2xndCBtZXQgbi1wIHZyaWpoZWlkc2dyYWRlbiBvbmRlciBkZSBudWwgaHlwb3RoZXNlIGFscyBhbGxlIGFhbm5hbWVzIHZhbiBoZXQgbW9kZWwgZ2VsZGlnIHppam4uCgpEZSBrcmFjaHQgdmFuIGRlIHRvZXRzIGlzIGRhbgoKJCRQKHAgPCAwLjA1IHwgSF8xKSQkCmVuIGhhbmd0IGFmIHZhbiAKCi0gZGUgd2Vya2VsaWprZSBlZmZlY3Rncm9vdHRlIGluIGRlIHBvcHVsYXRpZSAkXG1hdGhiZntMfV5UXGJvbGRzeW1ib2x7XGJldGF9JC4KLSBIZXQgYWFudGFsIG9ic2VydmF0aWVzOiBTRSBlbiBkZiB2YW4gdC10ZXN0LgotIEtldXplIHZhbiBkZSBkZXNpZ25wdW50ZW4KLSBLZXV6ZSB2YW4gc2lnbmlmaWNhbnRpZS1uaXZlYXUgJFxhbHBoYSQuIAoKV2Uga3VubmVuIGRpdCBldmFsdWVyZW4gYWFuIGRlIGhhbmQgdmFuIHNpbXVsYXRpZXMuCgojIyBNdWlzIHZvb3JiZWVsZAoKLSBJbiAyMDIxIHB1YmxpY2VlcmRlbiBDaG9hIGV0IGFsLiBkYXQgY3l0b2tpbmUgVGh5bWljIHN0cm9tYWwgbHltcGhvcG9pZXRpbgooVFNMUCkgdmV0dmVybGllcyBpbmR1Y2VlcnQgYmlqIG11aXplbiBkaWUgZWVuIHZldCBkaWVldCBrcmlqZ2VuIGRvb3IgZGUgc2VjcmV0aWUgdmFuIHRhbGcuIFtbaHRtbF0oaHR0cHM6Ly93d3cuc2NpZW5jZS5vcmcvZG9pL2Z1bGwvMTAuMTEyNi9zY2llbmNlLmFiZDI4OTMpXSBbW1BERl0oaHR0cHM6Ly93d3cuc2NpZW5jZS5vcmcvZG9pL3BkZi8xMC4xMTI2L3NjaWVuY2UuYWJkMjg5MyldCgotIFN0ZWwgZGF0IGplIGVlbiBnZWxpamthYXJkaWcgZXhwZXJpbWVudCBvcCB3aWwgemV0dGVuIG9tIG5hIHRlIGdhYW4gb2YgY3l0b2tpbmUgaW50ZXJsZXVraW4gMjUgKElMKSBvb2sgZWVuIGVmZmVjdCBoZWVmdCBvcCBoZXQgZ2V3aWNodCB2YW4gbXVpemVuLiAKCi0gSmUgcGxhbnQgZWVuIHN0dWRpZSBtZXQgZWVuIGNvbnRyb2xlIGdyb2VwIG11aXplbiBkaWUgZWVuIGhvb2cgdmV0IGRpZWV0IGtyaWpnZW4gIChIRkQpIGVuIGVlbiBiZWhhbmRlbGluZ3Nncm9lcCBkaWUgZWVuIEhGRCBkaWVldCBtZXQgSUwga3Jpamd0LiAKCi0gV2F0IGlzIGRlIHZlcmVpc3RlIHN0ZWVrcHJvZWZncm9vdHRlIG9tIGVlbiBiZXBhYWxkIGVmZmVjdCBvcCB0ZSBwaWtrZW4gdmFuIGRlIGJlaGFuZGVsaW5nPyAKCgojIyMgSG9lIHphbCBqZSBkZSBkYXRhIHZhbiBoZXQgZXhwZXJpbWVudCBhbmFseXNlcmVuPyAKCgotLS0KCgoKLSAkSF8wJDogRXIgaXMgZ2VlbiB2ZXJzY2hpbCBpbiBoZXQgZ2V3aWNodCB2YW4gbXVpemVuIGRpZSBlZW4gZGllZXQgbWV0IElMIGtyaWpnZW4gZW4gbXVpemVuIGRpZSBoZXQgY29udHJvbGUgZGllZXQga3Jpamdlbi4KLSAkSF8xJDogSGV0IGdld2ljaHQgaXMgZ2VtaWRkZWxkZSB2ZXJzY2hpbGxlbmQgdHVzc2VuIG11aXplbiBkaWUgaGV0IElMIGRpZWV0IGtyaWpnZW4gZW4gbXVpemVuIGRpZSBoZXQgY29udHJvbGUgZGllZXQga3Jpamdlbi4KCi0gVHdvIHNhbXBsZSB0LXRlc3Qgb2YgZWVuIHQtdGVzdCBvcCBkZSBoZWxsaW5nIHZhbiBoZXQgbGluZWFpcmUgbW9kZWwgbWV0IDEgZHVtbXkgdmFyaWFiZWxlCgokJCBZX2kgPSBcYmV0YV8wICsgXGJldGFfMSBYX1x0ZXh0e2lJTH0gKyBcZXBzaWxvbl9pJCQgCgokJApcdGV4dHttZXQgfQpYX1x0ZXh0e2lJTH09XGJlZ2lue2Nhc2VzfVhfe2lJTH09MCAmIFx0ZXh0e0hGRH1cXFhfe2lJTH09MSAmIFx0ZXh0e0hGRCArIElMfVxlbmR7Y2FzZXN9LgokJAoKLSBHZXNjaGF0dGUgZWZmZWN0Z3Jvb3R0ZT8KCiQkXGhhdFxkZWx0YSA9IFxiYXIgWF97SUx9IC0gXGJhciBYX3tjfSA9IFxoYXQgXGJldGFfMSQkCgotIFRlc3Qgc3RhdGlzdGllawokJApUID0gXGZyYWN7XGJhcntYfV97SUx9LVxiYXJ7WH1fe2N9fXtTRF9cdGV4dHtwb29sZWR9IFx0aW1lcyBcc3FydHtcZnJhY3sxfXtuXzF9ICsgXGZyYWN7MX17bl8yfX19ID0gXGZyYWN7XGhhdFxiZXRhXzF9e1x0ZXh0e1NFfV97XGhhdFxiZXRhXzF9fQokJAotICRcaGF0IFxiZXRhXzEkIGlzIGVlbiBvbnZlcnRla2VuZGUgc2NoYXR0ZXIgdmFuIGhldCB3ZXJrZWxpamsgZ2V3aWNodHN2ZXJzY2hpbCAoJFxkZWx0YSA9XG11X3tJTH0tXG11X3tjfSA9IFxiZXRhXzEkKSBkYXQgem91IHZvb3Jrb21lbiBpbiBkZSBwb3B1bGF0aWUgdmFuIG11aXplbiBnZXZvZWQgbWV0IEhGRCB2cyBtdWl6ZW4gZ2V2b2VkIG1ldCBIRkQgKyBJTC4gIAoKIyMjIFBvd2VyPyAKCiQkClBbcCA8IFxhbHBoYSBcdmVydCBcYmV0YV8xIFxuZXEgMF0KJCQKCgpEZSBrcmFjaHQgKHBvd2VyKSB6YWwgZHVzIGFmaGFuZ2VuIHZhbiAKCi0gSGV0IHdlcmtlbGlqa2UgZ2VtaWRkZWxkZSBnZXdpY2h0c3ZlcnNjaGlsICRcYmV0YV8xJCBpbiBkZSBwb3B1bGF0aWUuCi0gRGUgdmFyaWFiaWxpdGVpdCB2YW4gZGUgZ2V3aWNodHNtZXRpbmdlbgotIGhldCBzaWduaWZpY2FudGllLW5pdmVhdSAkXGFscGhhJAotIHN0ZWVrcHJvZWZncm9vdHRlICRuX3tJTH0kIGVuICRuX2MkIGluIGJlaWRlIGdyb2VwZW4gCgoKV2Uga3VubmVuIGRlIHBvd2VyIHNjaGF0dGVuIGFscyAKCjEuIHZvbGRhYW4gaXMgYWFuIGRlICBhYW5uYW1lbnMgdmFuIGhldCBtb2RlbDogZ2V3aWNodCBpbiBiZWlkZSBncm9lcGVuIGlzIG5vcm1hYWwgdmVyZGVlbGQgbWV0IGdlbGlqa2UgdmFyaWFudGllCgplbiBhbHMgd2UgZGUgCgoyLiBzdGFuZGFhcmQgZGV2aWF0aWUga2VubmVuIHZhbiBnZXdpY2h0c21ldGluZ2VuIHJvbmQgaHVuIGdyb2Vwc2dlbWlkZGVsZGUgdm9vciBtdWl6ZW4gZGllIGVlbiBIRkQgZGlldCBrcmlqZ2VuCgozLiBkZSBlY2h0ZSBlZmZlY3Rncm9vdHRlIGluIGRlIHBvcHVsYXRpZQo0LiAkbl8xJCBlbiAkbl8yJCAKCiMjIyBHZWJydWlrIGRhdGEgdWl0IHZvcmlnIGV4cGVyaW1lbnQgb20gaW56aWNodCB0ZSBrcmlqZ2VuIGluIGRlIGdld2ljaHRzZGF0YSB2YW4gbXVpemVuCgpTdGVsIGRhdCB3ZSB0b2VnYW5nIGhlYmJlbiB0b3QgZGF0YSB2YW4gZWVuIHZvcmlnIGV4cGVyaW1lbnQgKGhpZXIgZGF0IHZhbiBLYXJlbiBTdmVuc29uIGVuIERhbiBHYXR0aSwgZ2VmaW5hbmNpZXJkIGRvb3IgUDUwIEdNMDcwNjgzIGVuIGJlc2NoaWtiYWFyIG9wIFtQSDUyNXhdKGh0dHA6Ly9nZW5vbWljc2NsYXNzLmdpdGh1Yi5pby9ib29rL3BhZ2VzL3JhbmRvbV92YXJpYWJsZXMuaHRtbCkpCgpgYGB7cn0KbWljZSA8LSByZWFkLmNzdigiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2dlbm9taWNzY2xhc3MvZGFnZGF0YS9tYXN0ZXIvaW5zdC9leHRkYXRhL2ZlbWFsZU1pY2VXZWlnaHRzLmNzdiIpCgptaWNlICU+JSAKICBnZ3Bsb3QoYWVzKHg9RGlldCx5PUJvZHl3ZWlnaHQpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGU9RkFMU0UpICsKICBnZW9tX2ppdHRlcigpCgptaWNlICU+JSAKICBnZ3Bsb3QoYWVzKHNhbXBsZT1Cb2R5d2VpZ2h0KSkgKwogIGdlb21fcXEoKSArIAogIGdlb21fcXFfbGluZSgpICsKICBmYWNldF93cmFwKH5EaWV0KQpgYGAKCmBgYHtyfQptaWNlIDwtIG1pY2UgJT4lIG11dGF0ZShEaWV0ID0gYXMuZmFjdG9yKERpZXQpKQptaWNlU3VtIDwtIG1pY2UgJT4lIAogIGdyb3VwX2J5KERpZXQpICAlPiUKICBzdW1tYXJpemVfYXQoIkJvZHl3ZWlnaHQiLGxpc3QobWVhbj1+bWVhbiguLG5hLnJtPVRSVUUpLAogICAgICAgICAgICAgICAgICAgIHNkPX5zZCguLG5hLnJtPVRSVUUpLAogICAgICAgICAgICAgICAgICAgIG49ZnVuY3Rpb24oeCkgeCU+JWlzLm5hJT4lYCFgJT4lc3VtKSkgJT4lCiAgbXV0YXRlKHNlPXNkL3NxcnQobikpCm1pY2VTdW0gCmBgYAoKSW4gaGV0IGV4cGVyaW1lbnQgd2VyZGVuIHR3ZWUgZGnDq3RlbiBnZWJydWlrdDogCgotIGdld29vbiBkaWV0IG8uYi52LiBncmFuZW4gKENob3cpIAotIEhlZWwgdmV0IGRpZWV0IChoaWdoIGZhdDogaGYpCgpXZSBrdW5uZW4gZGUgZGF0YSB2YW4gZGUgaGYgbXVpemVuIGdlYnJ1aWtlbiBhbHMgaW5wdXQgdm9vciBvbnplIHBvd2VyIGFuYWx5c2UuIAoKLSBEZSBkYXRhIHZhbiBoZiBtdWl6ZW4gbGlqa2VuIG5vcm1hYWwgdmVyZGVlbGQgdGUgemlqbi4gIAotIEhldCBnZW1pZGRlbGRlIGdld2ljaHQgdmFuIGVlbiBoZiBtdWlzIGlzIGByIG1pY2VTdW0gJT4lIGZpbHRlcihEaWV0ID09ICJoZiIpICU+JSBwdWxsKCJtZWFuIikgJT4lIHJvdW5kKC4sMSlgZyAKLSBEZSBzdGFuZGFhcmQgZGV2aWF0aWUgKFNEKSB2YW4gaGV0IGdld2ljaHQgdmFuIGhmIG11aXplbiBpcyBgciBtaWNlU3VtICU+JSBmaWx0ZXIoRGlldCA9PSAiaGYiKSAlPiUgcHVsbCgic2QiKSAlPiUgcm91bmQoLiwxKWBnIAoKRWZmZWN0Z3Jvb3RlPyAKCi0gRGUgYWx0ZXJuYXRpdmUgaHlwb3RoZXNlIGlzIGNvbXBsZXguIAotIE9tdmF0IGFsbGUgbW9nZWxpamtlIGVmZmVjdGVuISAKLSBPbSBlZW4gcG93ZXIgYW5hbHlzZSB0ZSBkb2VuIGtpZXplbiB3ZSBkYWFyb20gZWVuIG1pbmltYWxlIGVmZmVjdGdyb290dGUgZGllIHdlIHdlbnNlbiBvcCB0ZSBwaWtrZW4gaW4gaGV0IG5pZXV3ZSBleHBlcmltZW50LiAKLSBWZXJvbmRlcnN0ZWwgZGF0IHdlIGVlbiBnZXdpY2h0c3ZlcnNjaGlsIHdpbGxlbiBvcHBpa2tlbiB2YW4gbWluaW1hYWwgMTAlLiAKCmBgYHtyfQpkZWx0YSA8LSAtIHJvdW5kKG1pY2VTdW0kbWVhblsyXSAqLjEsMSkKZGVsdGEKYGBgCgpNZXJrIG9wIGRhdCBoZXQgZ2VtaWRkZWxkIGdld2ljaHQgZGFuIGRpY2h0IGtvbXQgYmlqIGRhdCB2YW4gbXVpemVuIGluIGhldCBwaWxvb3RleHBlcmltZW50IGRpZSB3ZXJkZW4gZ2V2b2VkIG1ldCBoZXQgbm9ybWFsZSBkaWVldC4gCgpXZSBrdW5uZW4gbnUgZWVuIHNpbXVsYXRpZSBzdHVkaWUgb3B6ZXR0ZW4gb20gZGUgcG93ZXIgdGUgYmVyZWtlbmVuIHZvb3IgZWVuIGV4cGVyaW1lbnQgbWV0IDggbXVpemVuIGluIGVsa2UgZ3JvZXAuIAoKIyMjIyBFw6luIHNpbXVsYXRpZQoKYGBge3J9CnNldC5zZWVkKDE0MjMpCm4xIDwtIG4yIDwtIDgKYjAgPC0gcm91bmQobWljZVN1bSRtZWFuWzJdLDEpCmIxIDwtIC0gZGVsdGEKc2QgPC0gcm91bmQobWljZVN1bSRzZFsyXSwxKQphbHBoYSA8LSAwLjA1Cgp4IDwtIHJlcCgwOjEsYyhuMSxuMikpCnkgPC0gYjAgKyBiMSAqIHggKyBybm9ybShuMStuMiwwLCBzZCA9IHNkKQpmaXQgPC0gbG0oeX54KQpiaGF0IDwtIGZpdCRjb2VmIApzdGF0IDwtIHN1bW1hcnkoZml0KQpzdW1tYXJ5KGZpdCkkY29lZlsyLF0KYGBgCgpWb29yIGhldCBnZXNpbXVsZWVyZGUgZXhwZXJpbWVudCBrb25kZW4gd2UgaGV0IGVmZmVjdCB2YW4gZGUgYmVoYW5kZWxpbmcgYHIgaWZlbHNlKHN1bW1hcnkoZml0KSRjb2VmWzIsIlByKD58dHwpIl0gPCBhbHBoYSwiIiwibmlldCIpYCBvcHBpa2tlbiBiaWogaGV0ICAkXGFscGhhJD1gciBhbHBoYWAgKHAgPSBgciByb3VuZChzdW1tYXJ5KGZpdCkkY29lZlsyLCJQcig+fHR8KSJdLDIpYCkgc2lnbmlmaWNhbnRpZS1uaXZlYXUhIAoKLSBXZSBtb2V0ZW4gaGV0IGV4cGVyaW1lbnQgaGVyaGFsZW4gb20gZGUgcG93ZXIgdGUgc2NoYXR0ZW4uIAotIFdlIHp1bGxlbiBkZSBzaW11bGF0aWUgZGFhcm9tIGNvZGVyZW4gaW4gZWVuIGZ1bmN0aWUgZGllIHdlIGt1bm5lbiBoZXJnZWJydWlrZW4uIAoKIyMjIyBTaW11bGF0aWUgdmFuIGhlcmhhYWxkZSBleHBlcmltZW50ZW4gKHJlcGVhdGVkIGV4cGVyaW1lbnRzKQoKYGBge3J9CmxpYnJhcnkobXVsdGNvbXApCm4xIDwtIG4yIDwtIDgKCmIwIDwtIHJvdW5kKG1pY2VTdW0kbWVhblsyXSwxKQpiMSA8LSAtIGRlbHRhCgpzZCA8LSByb3VuZChtaWNlU3VtJHNkWzJdLDEpCnByZWRpY3RvckRhdGEgPC0gZGF0YS5mcmFtZShEaWV0ID0gcmVwKGMoImMiLCJoZiIpLGMobjEsbjIpKSAlPiUgYXMuZmFjdG9yKQoKYWxwaGEgPC0gMC4wNQoKc2ltTG0gPC0gZnVuY3Rpb24oZm9ybSwgZGF0YSwgYmV0YXMsIHNkLCBjb250cmFzdHMsIHNpbUluZGV4ID0gTkEpCnsKICBkYXRhU2ltIDwtIGRhdGEKICBYIDwtIG1vZGVsLm1hdHJpeChmb3JtLGRhdGFTaW0pCiAgZGF0YVNpbSR5U2ltIDwtIFglKiViZXRhcyArIHJub3JtKG5yb3coZGF0YVNpbSksMCxzZCkKICBmb3JtIDwtIGZvcm11bGEocGFzdGUoInlTaW0gfiIsZm9ybVtbMl1dKSkKICBmaXRTaW0gPC0gbG0oZm9ybSxkYXRhU2ltKQogIG1jcCA8LSBnbGh0KGZpdFNpbSxsaW5mY3QgPSBjb250cmFzdHMpCiAgcmV0dXJuKHN1bW1hcnkobWNwKSR0ZXN0W2MoImNvZWZmaWNpZW50cyIsInNpZ21hIiwidHN0YXQiLCJwdmFsdWVzIildJT4lIHVubGlzdCkKfQoKc2ltTG0oCiAgZm9ybSA9IH5EaWV0LAogIGRhdGEgPSBwcmVkaWN0b3JEYXRhLAogIGJldGFzID0gYyhiMCxiMSksCiAgc2QgPSBzZCwKICBjb250cmFzdHMgPSAiRGlldGhmID0gMCIpCmBgYAoKV2UgaGViYmVuIG51IGVlbiBnZW5lcmllayBmdW5jdGllIHdhYXJtZWUgd2UgZGF0YSBrdW5uZW4gc2ltdWxlcmVuIGRpZSBub3JtYWFsIHZlcmRlZWxkIHppam4gdm9vciBlbGsgbW9nZWxpamsgZGVzaWduIGRpZSB3ZSBtZXQgaGV0IGxpbmVhaXIgbW9kZWwga3VubmVuIGFuYWx5c2VyZW4uIAoKRGUgZnVuY3RpZSBoZWVmdCB2b2xnZW5kZSBhcmd1bWVudGVuOiAKCi0gYGZvcm1gOiBPbmUgc2lkZWQgZm9ybXVsYSBpbmNsdWRpbmcgdGhlIHN0cnVjdHVyZSBvZiB0aGUgcHJlZGljdG9ycyBpbiB0aGUgbW9kZWwgCi0gYGRhdGFgOiBEYXRhIGZyYW1lIHdpdGggdGhlIHByZWRpY3RvciB2YWx1ZXMgZm9yIHRoZSBkZXNpZ24KLSBgYmV0YXNgOiBBIHZlY3RvciB3aXRoIHZhbHVlcyBmb3IgYWxsIG1lYW4gbW9kZWwgcGFyYW1ldGVycwotIGBzZGA6IFRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2YgdGhlIGVycm9yIAotIGBjb250cmFzdHNgOiBhIHNjYWxhciBvciBhIHZlY3RvciB3aXRoIHRoZSBudWxsIGh5cG90aGVzZXMgdGhhdCB3ZSB3b3VsZCBsaWtlIHRvIGFzc2Vzcy4gCi0gYHNpbUluZGV4YDogYW4gYXJiaXRyYXJ5IGFyZ3VtZW50IHRoYXQgaXMgbm90IHVzZWQgYnkgdGhlICBmdW5jdGlvbiBidXQgdGhhdCB3aWxsIGFsbG93IGl0IHRvIGJlIHVzZWQgaW4gYW4gc2FwcGx5IGxvb3AgdGhhdCBydW5zIGZyb20gMSB1cCB0byB0aGUgbnVtYmVyIG9mIHNpbXVsYXRpb25zLiAKClNpbXVsZWVyIG5TaW0gPSAxMDAwIGhlcmhhYWxkZSBleHBlcmltZW50ZW46IAoKYGBge3J9CnNldC5zZWVkKDE0MjUpCm5TaW0gPC0gMTAwMAoKc2ltUmVzdWx0cyAgPC0gdChzYXBwbHkoMTpuU2ltLHNpbUxtLGZvcm0gPSB+RGlldCxkYXRhID0gcHJlZGljdG9yRGF0YSxiZXRhcyA9IGMoYjAsYjEpLHNkID0gc2QsY29udHJhc3RzID0gIkRpZXRoZiA9IDAiKSkKcG93ZXIgPC0gbWVhbihzaW1SZXN1bHRzWyw0XSA8IGFscGhhKQpwb3dlcgpgYGAKCldlIGhlYmJlbiBlZW4gcG93ZXIgdmFuIGByIHBvd2VyKjEwMGAlIG9tIGhldCBiZWhhbmRlbGluZ3NlZmZlY3Qgb3AgdGUgcGlra2VuIG1ldCA4IGJpb2xvZ2lzY2hlIGhlcmhhbGluZ2VuIGluIGVsa2UgYmVoYW5kZWxpbmdzZ3JvZXAuIAoKTWVyayBvcCBkYXQgZGUgcG93ZXIgdmFuIGVlbiBleHBlcmltZW50IG9vayBoZXQgaG9vZ3N0ZSBpcyBhbHMgaGV0IGFhbnRhbCBvYnNlcnZhdGllcyBnZWJhbGFuY2VlcmQgaXMsIG0uYS53LiAkbl8xPW5fMiQuIAoKIyMjIyBQb3dlciB2b29yIHZlcnNjaGlsbGVuZGUgc3RlZWtwcm9lZmdyb290dGVzIAoKV2Uga3VubmVuIGRlIHBvd2VyIG51IGJlcmVrZW5lbiB2b29yIG1lZXJkZXJlIHN0ZWVrcHJvZWZncm9vdGVzLiAKCmBgYHtyfQpwb3dlciA8LSBkYXRhLmZyYW1lKG49YygzLDUsMTAsMjUsNTAsNzUsMTAwKSxwb3dlcj1OQSkKCmZvciAoaSBpbiAxOm5yb3cocG93ZXIpKQp7CiAgbjEgPC0gbjIgPC0gcG93ZXIkbltpXQogIHByZWRpY3RvckRhdGEgPC0gZGF0YS5mcmFtZShEaWV0ID0gcmVwKGMoImMiLCJoZiIpLGMobjEsbjIpKSAlPiUgYXMuZmFjdG9yKQogIHNpbVJlc3VsdHMgIDwtIHQoc2FwcGx5KDE6blNpbSxzaW1MbSxmb3JtID0gfkRpZXQsZGF0YSA9IHByZWRpY3RvckRhdGEsYmV0YXMgPSBjKGIwLGIxKSxzZCA9IHNkLGNvbnRyYXN0cyA9ICJEaWV0aGYgPSAwIikpCiAgcG93ZXIkcG93ZXJbaV0gPC0gbWVhbihzaW1SZXN1bHRzWywicHZhbHVlcyJdIDwgYWxwaGEpCn0KcG93ZXIKYGBgCgpgYGB7cn0KcG93ZXIgJT4lIAogIGdncGxvdChhZXMoeD1uLHk9cG93ZXIpKSArCiAgZ2VvbV9saW5lKCkKYGBgCgojIyMjIEJlc3R1ZGVlciBwb3dlciBpbiBmdW5jdGllIHZhbiBzdGVla3Byb2VmZ3Jvb3R0ZSBlbiBlZmZlY3Rncm9vdHRlIAoKTWVyayBvcCBkYXQgCgotIGhldCB0ZWtlbiB2YW4gZGVsdGEgYXJiaXRyYWlyIGlzIG9tZGF0IHdlIHR3ZWV6aWpkaWcgdGVzdGVuLgotIGhldCBpbnRlcmNlcHQgYXJiaXRyYWlyIGlzIG9tZGF0IHdlIGFsbGVlbiB0ZXN0ZW4gb3AgJFxiZXRhXzEkCi0gV2UgbmVtZW4gZGFhcm9tIHR5cGlzY2ggJFxiZXRhXzAgPSAwJAoKYGBge3J9Cm5TaW0gPC0gMTAwMApiMCA8LSAwCmRlbHRhcyA8LSBjKDEsMiwzLDUsMTApCnNkIDwtIHJvdW5kKG1pY2VTdW0kc2RbMl0sMSkKbnMgPC0gIGMoMyw1LDEwLDIwLDI1LDUwLDc1LDEwMCkgIAoKcG93ZXIgPC0gZGF0YS5mcmFtZShiMT1yZXAoZGVsdGFzLGVhY2g9bGVuZ3RoKG5zKSksCiAgICAgICAgICAgICAgICAgICAgbj1yZXAobnMsbGVuZ3RoKGRlbHRhcykpLAogICAgICAgICAgICAgICAgICAgIHBvd2VyPU5BKQoKZm9yIChpIGluIDE6bnJvdyhwb3dlcikpCnsKICBiMSA8LXBvd2VyJGIxW2ldCiAgbjEgPC0gbjIgPC0gIHBvd2VyJG5baV0KICBwcmVkaWN0b3JEYXRhIDwtIGRhdGEuZnJhbWUoRGlldCA9IHJlcChjKCJjIiwiaGYiKSxjKG4xLG4yKSkgJT4lIGFzLmZhY3RvcikKICBzaW1SZXN1bHRzICA8LSB0KHNhcHBseSgxOm5TaW0sc2ltTG0sZm9ybSA9IH5EaWV0LGRhdGEgPSBwcmVkaWN0b3JEYXRhLGJldGFzID0gYyhiMCxiMSksc2QgPSBzZCxjb250cmFzdHMgPSAiRGlldGhmID0gMCIpKQogIHBvd2VyJHBvd2VyW2ldIDwtIG1lYW4oc2ltUmVzdWx0c1ssInB2YWx1ZXMiXSA8IGFscGhhKQp9CmBgYAoKYGBge3J9CnBvd2VyICU+JSAKICBnZ3Bsb3QoYWVzKHg9bix5PXBvd2VyLGNvbD1iMSU+JWFzLmZhY3RvcikpICsKICBnZW9tX2xpbmUoKQpgYGAKCk1lcmsgb3AgZGF0IGRlIHBvd2VyIGN1cnZlcyB3YXQgc2Nob2trZXJpZyB6aWpuIG9tZGF0IHdlIG1hYXIgZWVuIGJlcGVya3QgYWFudGFsIHN0ZWVrcHJvZWZncm9vdHRlcyBlbiBlZW4gYmVwZXJrdCBhYW50YWwgc2ltdWxhdGllcyB1aXR2b2VyZGVuLiAKVm9vciBkZSBsYWdlIHBvd2VycyBpcyBoZXQgYWFudGFsIHNpbXVsYXRpZXMgemVrZXIgb252b2xkb2VuZGUgb20gaGVlbCBiZXRyb3V3YmFyZSBzY2hhdHRpbmdlbiB2YW4gZGUgcG93ZXIgdGUgYmVrb21lbi4gCgojIE9wbWVya2luZ2VuCgotIERlIGNvZGUga2FuIGVlbnZvdWRpZyBhYW5nZXBhc3Qgd29yZGVuIG5hYXIgYW5kZXJlIGRlc2lnbnMgKHppZSBvZWZlbmluZ2VuKQogICAgCiAgICAtIHByZWRpY3RvciBkYXRhIAogICAgLSBmb3JtdWxhCiAgICAtIGNvbnRyYXN0CgotIERlIHNpbXVsYXRpZXMga3VubmVuIGxhbmcgZHVyZW4gd2FubmVlciBqZSB2ZWVsIHNjZW5hcmlvJ3MgZXZhbHVlZXJ0LiAgCiAgICAKICAgIC0gTWVlciBlZmZpY2nDq250ZSBjb2RlIG1ldCBtYXRyaWNlcwogICAgLSBWb29yIHR3byBncm91cCBjb21wYXJpc29uIGJlc3RhYXQgZWVuIGFuYWx5dGlzY2hlIG9wbG9zc2luZy4gCiAgICAKCgoKIyMgIE1lZXIgZWZmaWNpw6tudGUgY29kZSBtZXQgbWF0cmljZXMKCkNvZGUgaXMgdmVlbCBzbmVsbGVyLiBXZSBzaW11bGFsZXJlbiBudSAyMCBrZWVyIG1lZXIgZXhwZXJpbWVudGVuIGluIGVlbiB2ZWVsIGtvcnRlcmUgdGlqZCEgCgpgYGB7cn0KblNpbSA8LSAyMDAwMApiMCA8LSAwCnNkIDwtIHJvdW5kKG1pY2VTdW0kc2RbMl0sMSkKbnMgPC0gIGMoMyw1LDEwLDIwLDI1LDUwLDc1LDEwMCkgIApkZWx0YXMgPC0gYygxLDIsMyw1LDEwKQoKCnBvd2VyRmFzdCA8LSBtYXRyaXgoTkEsbnJvdz1sZW5ndGgobnMpKmxlbmd0aChkZWx0YXMpLG5jb2w9MykgJT4lIGFzLmRhdGEuZnJhbWUKbmFtZXMocG93ZXJGYXN0KSA8LSBjKCJiMSIsIm4iLCJwb3dlciIpCgppIDwtIDAKCmZvciAobiBpbiBucykKewogIG4xIDwtIG4yIDwtICBuCiAgCiAgIyMjIFNpbXVsYXRpb24KICBwcmVkaWN0b3JEYXRhIDwtIGRhdGEuZnJhbWUoRGlldCA9IHJlcChjKCJjIiwiaGYiKSxjKG4xLG4yKSkgJT4lIGFzLmZhY3RvcikKICBkZXNpZ24gPC0gbW9kZWwubWF0cml4KH5EaWV0LHByZWRpY3RvckRhdGEpCiAgTCA8LSBsaW1tYTo6bWFrZUNvbnRyYXN0cygiRGlldGhmIixsZXZlbHMgPSBjb2xuYW1lcyhkZXNpZ24pKQoKICAKICBmb3IgKGIxIGluIGRlbHRhcykKICB7CiAgICB5U2ltIDwtIHJub3JtKG5yb3cocHJlZGljdG9yRGF0YSkqblNpbSxzZD1zZCkKICAgIGRpbSh5U2ltKSA8LWMobnJvdyhwcmVkaWN0b3JEYXRhKSxuU2ltKQogICAgeVNpbSA8LSB5U2ltICsgYyhkZXNpZ24gJSolYyhiMCxiMSkpCiAgICB5U2ltIDwtIHQoeVNpbSkKICAKICAgICMjIyBGaXR0aW5nCiAgICBmaXRBbGwgPC0gbGltbWE6OmxtRml0KHlTaW0sZGVzaWduKQogIAogICAgIyMjIEluZmVyZW5jZQogICAgdmFyVW5zY2FsZWQgPC0gYyh0KEwpJSolZml0QWxsJGNvdi5jb2VmZmljaWVudHMlKiVMKQogICAgY29udHJhc3RzIDwtIGZpdEFsbCRjb2VmZmljaWVudHMgJSolTAogICAgc2VDb250cmFzdHMgPC0gdmFyVW5zY2FsZWReLjUqZml0QWxsJHNpZ21hCiAgICB0c3RhdHMgPC0gY29udHJhc3RzL3NlQ29udHJhc3RzCiAgICBwdmFscyA8LSBwdChhYnModHN0YXRzKSxmaXRBbGwkZGYucmVzaWR1YWwsbG93ZXIudGFpbCA9IEZBTFNFKSoyCiAgICAKICAgIGkgPC0gaSsxCiAgICBwb3dlckZhc3RbaSxdIDwtIGMoYjEsbixtZWFuKHB2YWxzIDwgYWxwaGEpKQogIH0KfQpgYGAKCmBgYHtyfQpwb3dlckZhc3QgJT4lIAogIGdncGxvdChhZXMoeD1uLHk9cG93ZXIsY29sPWIxJT4lYXMuZmFjdG9yKSkgKwogIGdlb21fbGluZSgpCmBgYAoKIyMgTWVlciBlZmZpY2nDq250ZSBjb2RlIGdlYmFzZWVyZCBvcCBkZSBhbmFseXRpc2NoZSBvcGxvc3Npbmcgdm9vciBlZW4gdHdvIGdyb3VwIGNvbXBhcmlzb24KCi0gVm9vciBkZSB0d28gc2FtcGxlIHQtdGVzdCBiZXN0YWF0IGVyIGVlbiBhbmFseXRpc2NoZSBvcGxvc3Npbmcgb20gZGUgcG93ZXIgdGUgYmVyZWtlbmVuLiAKCi0gSW4gZGV6ZSBjb250ZXh0IG1hYWt0IG1lbiB0eXBpc2NoIGdlYnJ1aWsgdmFuIGRlICJDb2hlbidzIGVmZmVjdCBzaXplIjogCgokRCA9IFxmcmFje1xkZWx0YX17U0R9JAoKCmBgYHtyfQpwb3dlci50LnRlc3Qobj04LCBkZWx0YSA9IGRlbHRhLCBzZCA9IHNkLCB0eXBlPSd0d28uc2FtcGxlJykKYGBgCgpNZXJrIG9wIGRhdCBkZSBwb3dlciBvdmVyZWVua29tdCBtZXQgZGVnZW5lIGRpZSB3ZSB2aWEgc2ltdWxhdGllcyBoZWJiZW4gZ2VzY2hhdCEgCgoKYGBge3J9CmIwIDwtIDAKc2QgPC0gcm91bmQobWljZVN1bSRzZFsyXSwxKQpucyA8LSAgYygzLDUsMTAsMjAsMjUsNTAsNzUsMTAwKSAgCmRlbHRhcyA8LSBjKDEsMiwzLDUsMTApCgoKcG93ZXJUaGVvIDwtIGRhdGEuZnJhbWUoZGVsdGFzPXJlcChkZWx0YXMsZWFjaD1sZW5ndGgobnMpKSwKICAgICAgICAgICAgICAgICAgICBuPXJlcChucyxsZW5ndGgoZGVsdGFzKSksCiAgICAgICAgICAgICAgICAgICAgcG93ZXI9TkEpCgpwb3dlclRoZW8kcG93ZXIgPC0gYXBwbHkocG93ZXJUaGVvWywxOjJdLDEsZnVuY3Rpb24oeCkgcG93ZXIudC50ZXN0KGRlbHRhPXhbMV0sbj14WzJdLHNkPXNkLHR5cGU9InR3by5zYW1wbGUiKSRwb3dlcikKYGBgCgoKYGBge3J9CnBvd2VyVGhlbyAlPiUgCiAgZ2dwbG90KGFlcyh4PW4seT1wb3dlcixjb2w9ZGVsdGFzJT4lYXMuZmFjdG9yKSkgKwogIGdlb21fbGluZSgpCmBgYA==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("experimentalDesignI.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
