<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement and Jeroen Gilis" />


<title>Exercise 8.x: Blocking on the rat diet dataset - solution</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biostatistiek</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Hoorcolleges
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductie</a>
    </li>
    <li>
      <a href="10-MultipleRegression.html">Algemeen Lineair Model</a>
    </li>
    <li>
      <a href="10-MultipleRegression-FactorialDesigns.html">Factoriële Designs</a>
    </li>
    <li>
      <a href="experimentalDesignI.html">Experimental Design I</a>
    </li>
    <li>
      <a href="experimentalDesignII.html">Experimental Design II</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ttest_example.html">Practicum 1: Voorbeeld two-sample t-test</a>
    </li>
    <li>
      <a href="anova_example.html">Practicum 1: Voorbeeld anova</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_1.html">Practicum 1: Voorbereiding 1</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_2.html">Practicum 1: Voorbereiding 2</a>
    </li>
    <li>
      <a href="Practicum_1_Voorbereiding_3.html">Practicum 1: Voorbereiding 3</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_Two_sample_t_test.html">Practicum 1: Oplossing Voorbereiding 1</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_anova.html">Practicum 1: Oplossing Voorbereiding 2</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_niet_parametrische_test.html">Practicum 1: Oplossing Voorbereiding 3</a>
    </li>
    <li>
      <a href="Practicum_1_oefening_4.html">Practicum 2: Oefening lineair model</a>
    </li>
    <li>
      <a href="Practicum_1_oplossing_lineair_model.html">Practicum 1: Oplossing lineair model</a>
    </li>
    <li>
      <a href="oefening_vissen_volledig_uitgewerkt.html">Practicum 3: Algemeen lineair model - Oplossing Oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_1_ex_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oefening 1</a>
    </li>
    <li>
      <a href="Exp_design_fast_2_ex_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_3_ex_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oefening 3</a>
    </li>
    <li>
      <a href="Exp_design_fast_1_sol_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 1</a>
    </li>
    <li>
      <a href="Exp_design_fast_2_sol_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 2</a>
    </li>
    <li>
      <a href="Exp_design_fast_3_sol_new_contrasts.html">Practicum 4: Experimenteel design: krachtanalyse oplossing oefening 3</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/biostatistics">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise 8.x: Blocking on the rat diet
dataset - solution</h1>
<h4 class="author">Lieven Clement and Jeroen Gilis</h4>
<h4 class="date">statOmics, Ghent University (<a
href="https://statomics.github.io"
class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="background" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Background</h1>
<p>Researchers are studying the impact of protein sources and protein
levels in the diet on the weight of rats. They feed the rats with diets
of beef, cereal and pork and use a low and high protein level for each
diet type. The researchers can include 60 rats in the experiment. Prior
to the experiment, the rats were divided in 10 homogeneous groups of 6
rats based on characteristics such as initial weight, appetite, etc.</p>
<p>Within each group a rat is randomly assigned to a diet. The rats are
fed during a month and the weight gain in grams is recorded for each
rat.</p>
</div>
<div id="experimental-design" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Experimental
design</h1>
<ul>
<li><p>There are three explanatory variables in the experiment: the
factor diet type with three levels (beef, cereal and pork), factor
protein level with levels (low and high) and a group blocking factor
with 10 levels.</p></li>
<li><p>There are 6 treatments: beef-high, cereal-high, pork-high,
beef-low, cereal-low, pork-low protein.</p></li>
<li><p>The rats are the experimental units (the unit to which a
treatment is applied): in this design, there is a randomisation
restriction: Within a block, a rat is randomly assigned to a
diet.</p></li>
<li><p>The rats are the observational units (the unit on which the
response is measured): The weight is weighted for each rat.</p></li>
<li><p>The weight gain is the response variable.</p></li>
<li><p>The experiment is a randomized complete block (RCB)
design</p></li>
</ul>
<p>Load libraries</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-import" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Data import</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>diet <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/PSLS21/data/dietRats.txt&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diet)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["weightGain"],"name":[1],"type":["int"],"align":["right"]},{"label":["protSource"],"name":[2],"type":["chr"],"align":["left"]},{"label":["protLevel"],"name":[3],"type":["chr"],"align":["left"]},{"label":["block"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"107","2":"b","3":"h","4":"1","_rn_":"1"},{"1":"96","2":"c","3":"h","4":"1","_rn_":"2"},{"1":"112","2":"p","3":"h","4":"1","_rn_":"3"},{"1":"83","2":"b","3":"l","4":"1","_rn_":"4"},{"1":"87","2":"c","3":"l","4":"1","_rn_":"5"},{"1":"90","2":"p","3":"l","4":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="tidy-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Tidy data</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>diet <span class="ot">&lt;-</span> diet <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">as.factor</span>(block),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">protSource =</span> <span class="fu">as.factor</span>(protSource),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">protLevel =</span> <span class="fu">as.factor</span>(protLevel)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">protLevel =</span> <span class="fu">fct_relevel</span>(protLevel, <span class="st">&quot;l&quot;</span>))</span></code></pre></div>
</div>
<div id="data-exploration" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Data exploration</h1>
<ul>
<li>Boxplot of the weight gain against protein source, protein level
with coloring according to block</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>diet <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>protLevel, <span class="at">y=</span>weightGain)) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span>block)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Weight gain dependence on protein source&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Weigth gain (g)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#stat_summary(fun = mean, geom=&quot;point&quot;, shape=5, size=3, color=&quot;black&quot;, fill=&quot;black&quot;) +</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>protSource)</span></code></pre></div>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ul>
<li>Lineplot of the weight gain against protein source, protein level
with coloring and grouping according to block</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>diet <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>protSource<span class="sc">:</span>protLevel, <span class="at">y=</span>weightGain)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;RdGy&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>block, <span class="at">color=</span>block)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>block))<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Weight gain dependence on protein source&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Weigth gain (g)&quot;</span>) </span></code></pre></div>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#stat_summary(fun = mean, geom=&quot;point&quot;, shape=5, size=3, color=&quot;black&quot;, fill=&quot;black&quot;)</span></span></code></pre></div>
<ul>
<li><p>An increase in the weight of the rats seems to depend on the
protein source received in the diet.</p></li>
<li><p>The increase in the weight of the rats seems to depend on the
level of protein received in the diet</p></li>
<li><p>There also seems to be an interaction effect between the protein
level and the protein source on the gain in weight of the rats. For the
beef and the pork diets the effect of high protein levels in the data
seems to be much stronger than in the cereal diet.</p></li>
<li><p>There is also a strong effect of the block. Blocking implies a
randomisation restriction, hence, we will have to include the block
effect anyway.</p></li>
</ul>
</div>
<div id="multivariate-linear-regression-analysis" class="section level1"
number="6">
<h1><span class="header-section-number">6</span> Multivariate linear
regression analysis</h1>
<div id="assumptions" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Assumptions</h2>
<p>List assumptions:</p>
<ol style="list-style-type: decimal">
<li>The observations are independent</li>
<li>Linearity between the response and predictor variable</li>
<li>The residuals of the model must be normally distributed</li>
<li>Homoscedasticity of the data</li>
</ol>
<p>The first assumption is met if we correct for block in the model
because the rats were randomized to the treatment within block. The
other three assumptions can be assessed by fitting the linear model and
calling the <code>plot()</code> function as follows.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weightGain <span class="sc">~</span> block <span class="sc">+</span> protSource<span class="sc">*</span>protLevel, <span class="at">data=</span>diet)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1)</span></code></pre></div>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-6-1.png" width="672" /><img src="Rats_02_files/figure-html/unnamed-chunk-6-2.png" width="672" /><img src="Rats_02_files/figure-html/unnamed-chunk-6-3.png" width="672" /><img src="Rats_02_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<p>All assumptions are met for this dataset.</p>
</div>
<div id="hypothesis-testing" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Hypothesis
testing</h2>
<p>We here fit a linear model with a blocking factor for
<code>block</code> and main and interaction effects for protein source
and protein level.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.017  -5.183  -1.017   4.092  18.983 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             88.3500     4.1728  21.173  &lt; 2e-16 ***
## block2                  -9.1667     4.8183  -1.902 0.063520 .  
## block3                  -4.8333     4.8183  -1.003 0.321166    
## block4                 -20.3333     4.8183  -4.220 0.000117 ***
## block5                  -9.3333     4.8183  -1.937 0.059031 .  
## block6                   0.6667     4.8183   0.138 0.890572    
## block7                 -31.3333     4.8183  -6.503 5.58e-08 ***
## block8                 -10.1667     4.8183  -2.110 0.040450 *  
## block9                 -19.8333     4.8183  -4.116 0.000162 ***
## block10                 -0.1667     4.8183  -0.035 0.972559    
## protSourcec              1.1000     3.7322   0.295 0.769556    
## protSourcep              1.3000     3.7322   0.348 0.729226    
## protLevelh              20.0000     3.7322   5.359 2.76e-06 ***
## protSourcec:protLevelh -18.2000     5.2782  -3.448 0.001236 ** 
## protSourcep:protLevelh  -1.7000     5.2782  -0.322 0.748883    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.346 on 45 degrees of freedom
## Multiple R-squared:  0.7712, Adjusted R-squared:    0.7 
## F-statistic: 10.83 on 14 and 45 DF,  p-value: 3.726e-10</code></pre>
</div>
<div id="interpretation-of-the-regression-parameters"
class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Interpretation of the
regression parameters</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ExploreModelMatrix)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ExploreModelMatrix<span class="sc">::</span><span class="fu">VisualizeDesign</span>(diet, <span class="sc">~</span> block <span class="sc">+</span> protSource <span class="sc">*</span> protLevel)<span class="sc">$</span>plotlist</span></code></pre></div>
<pre><code>## $`block = 1`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>## 
## $`block = 10`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre><code>## 
## $`block = 2`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre><code>## 
## $`block = 3`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<pre><code>## 
## $`block = 4`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-5.png" width="672" /></p>
<pre><code>## 
## $`block = 5`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-6.png" width="672" /></p>
<pre><code>## 
## $`block = 6`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-7.png" width="672" /></p>
<pre><code>## 
## $`block = 7`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-8.png" width="672" /></p>
<pre><code>## 
## $`block = 8`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-9.png" width="672" /></p>
<pre><code>## 
## $`block = 9`</code></pre>
<p><img src="Rats_02_files/figure-html/unnamed-chunk-8-10.png" width="672" /></p>
<p>There are 3 levels for protein source, 2 levels for protein level and
10 levels for the blocking variable. We will have one reference level
for each respective variable: beef, low, block 1. So we need 2, 1 and 9
dummy variables to introduce the factors protein source, protein level
and block in the linear model, respectively.</p>
<p>Hence, we can write down the linear model as follows:</p>
<p><span class="math inline">\(y_i=\beta_0+\beta_cx_{i,c}
+\beta_px_{i,p}+\beta_hx_{i,h}+\beta_{ch}x_{i,c}x_{i,h}+\beta_{ph}x_{i,p}x_{i,h}+\beta_{b2}x_{i,b2}+\ldots+\beta_{b10}x_{i,b10}+\epsilon_{i}\)</span></p>
<p>with: <span class="math inline">\(y_i\)</span> the observed weight
gain for rat i, <span class="math inline">\(x_{i,h}\)</span> a dummy
variable which is 1 if rat i receives a high protein diet and is 0
otherwise,<br />
<span class="math inline">\(x_{i,c}\)</span> a dummy variable which is 1
if rat i receives a cereal diet and is 0 otherwise,<br />
<span class="math inline">\(x_{i,p}\)</span> a dummy variable which is 1
if rat i receives a pork diet and is 0 otherwise and <span
class="math inline">\(x_{i,bk}\)</span> is a dummy variable which is 1
if rat i belongs to block <span class="math inline">\(bk\)</span> and is
0 otherwise, with <span class="math inline">\(k \in 2,\ldots,
10\)</span>, and <span class="math inline">\(\epsilon_i\)</span> an
error term which is normally distributed with mean 0 and variance <span
class="math inline">\(\sigma^2\)</span>, i.e. <span
class="math inline">\(\epsilon_i \sim N(0,\sigma^2)\)</span>.</p>
<ul>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a beef based low protein
diet have a covariate pattern <span
class="math inline">\(x_{i,h}=0\)</span>, <span
class="math inline">\(x_{i,c}=0\)</span>, <span
class="math inline">\(x_{i,p}=0\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is
thus equal to <span
class="math inline">\(\mu_{l,b,bk}=\beta_0+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a beef based high protein
diet have a covariate pattern <span
class="math inline">\(x_{i,h}=1\)</span>, <span
class="math inline">\(x_{i,c}=0\)</span>, <span
class="math inline">\(x_{i,p}=0\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is
thus equal to <span
class="math inline">\(\mu_{h,b,bk}=\beta_0+\beta_h+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a cereal based low protein
diet have a covariate pattern <span
class="math inline">\(x_{i,h}=0\)</span>, <span
class="math inline">\(x_{i,c}=1\)</span>, <span
class="math inline">\(x_{i,p}=0\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is
thus equal to <span
class="math inline">\(\mu_{h,c,bk}=\beta_0+\beta_c+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a cereal based heigh
protein diet have a covariate pattern <span
class="math inline">\(x_{i,h}=1\)</span>, <span
class="math inline">\(x_{i,c}=1\)</span>, <span
class="math inline">\(x_{i,p}=0\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is
thus equal to <span
class="math inline">\(\mu_{h,c,bk}=\beta_0+\beta_h+\beta_c+\beta_{ch}+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a pork based low protein
diet have a covariate pattern <span
class="math inline">\(x_{i,h}=0\)</span>, <span
class="math inline">\(x_{i,c}=0\)</span>, <span
class="math inline">\(x_{i,p}=1\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. Their mean weight gain is
thus equal to <span
class="math inline">\(\mu_{l,p,bk}=\beta_0+\beta_p+\beta_{bk}\)</span></p></li>
<li><p>Rats that are assigned to block <span
class="math inline">\(k\)</span> and receive a pork based heigh protein
diet have a covariate pattern <span
class="math inline">\(x_{i,h}=1\)</span>, <span
class="math inline">\(x_{i,c}=0\)</span>, <span
class="math inline">\(x_{i,p}=1\)</span>, <span
class="math inline">\(x_{i,bm}=0\)</span> with <span
class="math inline">\(m\neq k\)</span> and <span
class="math inline">\(x_{i,bk}=1\)</span>. There mean weight gain is
thus equal to <span
class="math inline">\(\mu_{h,p,bk}=\beta_0+\beta_h+\beta_p+\beta_{ph}+\beta_{bk}\)</span></p></li>
</ul>
<p>We can now relate this to the output of the <code>lm</code>
function:</p>
<ul>
<li><p>The intercept <span class="math inline">\(\beta_0\)</span> is
thus the average weight increase in the low beef diet for rats in block
1.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_c\)</span>: the
average difference in weight gain between cereal-low and beef-low diet
is 1.1g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_p\)</span>: the
average difference in weight gain between pork-low and beef-low diet is
1.3g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_h\)</span>: the
average difference in weight gain between beef-high and beef-Low diet is
20g.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_{ch}\)</span> is
the difference in the average weight gain difference due to the high
protein level as compared to the low protein level for cereal diets as
compared to the weight gain difference that occurs due to the protein
level in the reference class (here beef diet). Here this is negative,
i.e. -18.2g, thus the weight gain for the cereal protein source
increases on average less between high and low protein diets than in
beef based diets.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_{ph}\)</span> is
the difference in the average weight gain difference due to the high
protein level as compared to the low protein level for pork diets as
compared to the weight gain difference that occurs due to the protein
level in the reference class (here beef diet). Here this is negative,
i.e. -1.7g, thus the weight gain for the proc protein source increases
on average less between high and low protein diets than in beef based
diets.</p></li>
</ul>
</div>
<div id="testing-the-overall-combined-effect-of-diet"
class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Testing the overall
(combined) effect of diet</h2>
<p>Because there are multiple factors with different levels in the
model, we can first assess the effect of the diet (protein Level,
protein source and the interaction) by using anova. With this test we
will assess the null hypothesis that the average weight gain in each
treatment is equal: i.e. <span class="math inline">\(H_0:
\mu_{b,l}=\mu_{b,h}=\mu_{c,h}=\mu_{c,l}=\mu_{p,h}=\mu_{p,h}\)</span>
versus the alternative hyptohesis <span
class="math inline">\(H_1:\)</span> that at least two treatment means
are different.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lm0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weightGain <span class="sc">~</span> block, <span class="at">data=</span>diet)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm0, lm1)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"50","2":"7728.833","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"45","2":"3134.150","3":"5","4":"4594.683","5":"13.19406","6":"6.308133e-08","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can conclude that there is an extremely significant effect of the
diet type (protein source and/or protein level and/or protein
source-protein level interaction) on the weight gain of rats (p &lt;&lt;
0.001).</p>
</div>
<div
id="assessing-the-interaction-effect-between-protein-source-and-protein-level"
class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Assessing the
interaction effect between protein source and protein level</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lm1, <span class="at">type=</span><span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"31222.890","2":"1","3":"448.297002","4":"4.955763e-25","_rn_":"(Intercept)"},{"1":"5969.350","2":"9","3":"9.523076","4":"6.083601e-08","_rn_":"block"},{"1":"9.800","2":"2","3":"0.070354","4":"9.321661e-01","_rn_":"protSource"},{"1":"2000.000","2":"1","3":"28.715920","4":"2.762595e-06","_rn_":"protLevel"},{"1":"1010.633","2":"2","3":"7.255316","4":"1.857393e-03","_rn_":"protSource:protLevel"},{"1":"3134.150","2":"45","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>There is a very significant interaction between the protein source
and the protein level (p = 2e-03). This indicates that the average
weight increase due to the protein level differs according to the
protein source. Hence, we cannot assess the effect of the protein source
and/or protein level independently because there effects of the protein
source vary according to the protein level.</p>
</div>
<div id="assessing-specific-contrasts" class="section level2"
number="6.6">
<h2><span class="header-section-number">6.6</span> Assessing specific
contrasts</h2>
<p>Imagine that we are interested in assessing if there is an effect
of</p>
<ol style="list-style-type: decimal">
<li>protein source in the low protein diets
<ul>
<li><span class="math inline">\(\mu_{c,l}-\mu_{b,l} =
\beta_c\)</span></li>
<li><span class="math inline">\(\mu_{p,l}-\mu_{b,l} =
\beta_p\)</span></li>
<li><span class="math inline">\(\mu_{c,l}-\mu_{p,l}=
\beta_c-\beta_p\)</span>)</li>
</ul></li>
<li>protein source in high protein diets
<ul>
<li><span
class="math inline">\(\mu_{c,h}-\mu_{b,h}=\beta_c+\beta_{ch}\)</span></li>
<li><span
class="math inline">\(\mu_{p,h}-\mu_{b,h}=\beta_p+\beta_{ph}\)</span></li>
<li><span
class="math inline">\(\mu_{p,h}-\mu_{c,h}=(\beta_c+\beta_{ch})-(\beta_p+\beta_{ph})\)</span></li>
</ul></li>
<li>protein level for
<ul>
<li>beef diets (<span
class="math inline">\(\mu_{b,h}-\mu_{b,l}=\beta_h\)</span>),</li>
<li>cereal diets (<span
class="math inline">\(\mu_{c,h}-\mu_{c,l}=\beta_h+\beta_{ch}\)</span>)
and</li>
<li>pork diets (<span
class="math inline">\(\mu_{p,h}-\mu_{p,l}=\beta_h+\beta_{ph}\)</span>).</li>
</ul></li>
<li>If the effect of the protein level differs between
<ul>
<li>beef and cereal <span class="math inline">\((\mu_{c,h}-\mu_{c,l}) -
(\mu_{b,h}-\mu_{b,l})=\beta_{ch}\)</span></li>
<li>beef and pork <span class="math inline">\((\mu_{p,h}-\mu_{p,l}) -
(\mu_{c,h}-\mu_{c,l})=\beta_{ph}\)</span> and</li>
<li>cereal and pork diets <span
class="math inline">\((\mu_{c,h}-\mu_{c,l}) -
(\mu_{p,h}-\mu_{p,l})=\beta_{ch}-\beta_{ph}\)</span>.</li>
</ul></li>
</ol>
<p>These effects of interest are so-called <strong>contrasts,
i.e. linear combinations of the parameters</strong>.</p>
<p>We can define the contrasts and assess the significance of the
contrasts with the code below. The contrasts are given as input in the
form of symbolic descriptions to the <code>linfct</code> argument of the
<code>glht</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">75468</span>) <span class="co"># to get reproducible results (small effect if removed)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>lm1MultComp <span class="ot">&lt;-</span> <span class="fu">glht</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> lm1,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">linfct =</span> <span class="fu">c</span>(<span class="st">&quot;protSourcec = 0&quot;</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcep = 0&quot;</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcec- protSourcep = 0&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcec + protSourcec:protLevelh = 0&quot;</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcep + protSourcep:protLevelh = 0&quot;</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;(protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) = 0&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protLevelh = 0&quot;</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protLevelh +  protSourcec:protLevelh = 0&quot;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protLevelh +  protSourcep:protLevelh = 0&quot;</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcec:protLevelh = 0&quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcep:protLevelh = 0&quot;</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;protSourcec:protLevelh - protSourcep:protLevelh = 0&quot;</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1MultComp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Linear Hypotheses:
##                                                                                      Estimate
## protSourcec == 0                                                                        1.100
## protSourcep == 0                                                                        1.300
## protSourcec - protSourcep == 0                                                         -0.200
## protSourcec + protSourcec:protLevelh == 0                                             -17.100
## protSourcep + protSourcep:protLevelh == 0                                              -0.400
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0  -16.700
## protLevelh == 0                                                                        20.000
## protLevelh + protSourcec:protLevelh == 0                                                1.800
## protLevelh + protSourcep:protLevelh == 0                                               18.300
## protSourcec:protLevelh == 0                                                           -18.200
## protSourcep:protLevelh == 0                                                            -1.700
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                  -16.500
##                                                                                      Std. Error
## protSourcec == 0                                                                          3.732
## protSourcep == 0                                                                          3.732
## protSourcec - protSourcep == 0                                                            3.732
## protSourcec + protSourcec:protLevelh == 0                                                 3.732
## protSourcep + protSourcep:protLevelh == 0                                                 3.732
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0      3.732
## protLevelh == 0                                                                           3.732
## protLevelh + protSourcec:protLevelh == 0                                                  3.732
## protLevelh + protSourcep:protLevelh == 0                                                  3.732
## protSourcec:protLevelh == 0                                                               5.278
## protSourcep:protLevelh == 0                                                               5.278
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                      5.278
##                                                                                      t value
## protSourcec == 0                                                                       0.295
## protSourcep == 0                                                                       0.348
## protSourcec - protSourcep == 0                                                        -0.054
## protSourcec + protSourcec:protLevelh == 0                                             -4.582
## protSourcep + protSourcep:protLevelh == 0                                             -0.107
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0  -4.475
## protLevelh == 0                                                                        5.359
## protLevelh + protSourcec:protLevelh == 0                                               0.482
## protLevelh + protSourcep:protLevelh == 0                                               4.903
## protSourcec:protLevelh == 0                                                           -3.448
## protSourcep:protLevelh == 0                                                           -0.322
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                  -3.126
##                                                                                      Pr(&gt;|t|)
## protSourcec == 0                                                                       0.9995
## protSourcep == 0                                                                       0.9989
## protSourcec - protSourcep == 0                                                         1.0000
## protSourcec + protSourcec:protLevelh == 0                                              &lt;0.001
## protSourcep + protSourcep:protLevelh == 0                                              1.0000
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0   &lt;0.001
## protLevelh == 0                                                                        &lt;0.001
## protLevelh + protSourcec:protLevelh == 0                                               0.9949
## protLevelh + protSourcep:protLevelh == 0                                               &lt;0.001
## protSourcec:protLevelh == 0                                                            0.0118
## protSourcep:protLevelh == 0                                                            0.9993
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                   0.0265
##                                                                                         
## protSourcec == 0                                                                        
## protSourcep == 0                                                                        
## protSourcec - protSourcep == 0                                                          
## protSourcec + protSourcec:protLevelh == 0                                            ***
## protSourcep + protSourcep:protLevelh == 0                                               
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0 ***
## protLevelh == 0                                                                      ***
## protLevelh + protSourcec:protLevelh == 0                                                
## protLevelh + protSourcep:protLevelh == 0                                             ***
## protSourcec:protLevelh == 0                                                          *  
## protSourcep:protLevelh == 0                                                             
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm1MultComp)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Fit: lm(formula = weightGain ~ block + protSource * protLevel, data = diet)
## 
## Quantile = 2.8765
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##                                                                                      Estimate
## protSourcec == 0                                                                       1.1000
## protSourcep == 0                                                                       1.3000
## protSourcec - protSourcep == 0                                                        -0.2000
## protSourcec + protSourcec:protLevelh == 0                                            -17.1000
## protSourcep + protSourcep:protLevelh == 0                                             -0.4000
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0 -16.7000
## protLevelh == 0                                                                       20.0000
## protLevelh + protSourcec:protLevelh == 0                                               1.8000
## protLevelh + protSourcep:protLevelh == 0                                              18.3000
## protSourcec:protLevelh == 0                                                          -18.2000
## protSourcep:protLevelh == 0                                                           -1.7000
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                 -16.5000
##                                                                                      lwr     
## protSourcec == 0                                                                      -9.6358
## protSourcep == 0                                                                      -9.4358
## protSourcec - protSourcep == 0                                                       -10.9358
## protSourcec + protSourcec:protLevelh == 0                                            -27.8358
## protSourcep + protSourcep:protLevelh == 0                                            -11.1358
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0 -27.4358
## protLevelh == 0                                                                        9.2642
## protLevelh + protSourcec:protLevelh == 0                                              -8.9358
## protLevelh + protSourcep:protLevelh == 0                                               7.5642
## protSourcec:protLevelh == 0                                                          -33.3827
## protSourcep:protLevelh == 0                                                          -16.8827
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                 -31.6827
##                                                                                      upr     
## protSourcec == 0                                                                      11.8358
## protSourcep == 0                                                                      12.0358
## protSourcec - protSourcep == 0                                                        10.5358
## protSourcec + protSourcec:protLevelh == 0                                             -6.3642
## protSourcep + protSourcep:protLevelh == 0                                             10.3358
## (protSourcec + protSourcec:protLevelh) - (protSourcep + protSourcep:protLevelh) == 0  -5.9642
## protLevelh == 0                                                                       30.7358
## protLevelh + protSourcec:protLevelh == 0                                              12.5358
## protLevelh + protSourcep:protLevelh == 0                                              29.0358
## protSourcec:protLevelh == 0                                                           -3.0173
## protSourcep:protLevelh == 0                                                           13.4827
## protSourcec:protLevelh - protSourcep:protLevelh == 0                                  -1.3173</code></pre>
<p>Note that the p-values and the confidence intervals are automatically
corrected for multiple testing.</p>
</div>
</div>
<div id="conclusion" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Conclusion</h1>
<ul>
<li><p>There is an extremely significant effect of the type of protein
diet on the weight gain of rats (p&lt;&lt;1e-6). The interaction between
protein type and protein source is also very significant
(p=0.0019).</p></li>
<li><p>The average weight gain does not vary significantly according to
protein source in the diets with low protein levels (all
p&gt;0.99).</p></li>
<li><p>The weight gain in the cereal diet at high protein concentration
is on average 17.1g and 16.7g g lower than in the high protein beef and
pork diet, respectively (95% CI [6.4, 27.8] and [6, 27.4]) and the
differences are extremely significant (p&lt;0.001). The average weight
gains after meat based diets at high protein levels, however, do not
differ significantly (p&gt;0.99).</p></li>
<li><p>We also discovered an extremely significant difference in weight
gain according to the protein level for beef and pork based diets
(p&lt;0.001).<br />
The weight gain on average increases with 20g and 18.3g in the high
protein level as compared to the low protein beef and pork diet,
respectively (95%CI [9.3, 30.7] and [7.6, 29]). The protein level effect
is not significant for the cereal diet (p&gt;0.99).</p></li>
<li><p>Finally significant interactions between protein level and
protein source were found (p&lt;0.05), i.e. the increase in weight gain
due to protein level in cereal based diets was 18.2g and 16.5g lower
than that of beef and pork based diets, respectively (95% CI [3g,33.4g]
and [1.3g,31.7g]). The average difference in increase in weight gain due
to protein level among the meat based diets was not significant
(p&gt;0.99).</p></li>
</ul>
<p>All reported p-values and confidence intervals were corrected for
multiple testing</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhlcmNpc2UgOC54OiBCbG9ja2luZyBvbiB0aGUgcmF0IGRpZXQgZGF0YXNldCAtIHNvbHV0aW9uIiAgIAphdXRob3I6ICJMaWV2ZW4gQ2xlbWVudCBhbmQgSmVyb2VuIEdpbGlzIgpkYXRlOiAic3RhdE9taWNzLCBHaGVudCBVbml2ZXJzaXR5IChodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8pIiAgCm91dHB1dDoKICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUgICAgCiAgICAgIHRoZW1lOiBjb3NtbwogICAgICB0b2M6IHRydWUKICAgICAgdG9jX2Zsb2F0OiB0cnVlCiAgICAgIGhpZ2hsaWdodDogdGFuZ28KICAgICAgbnVtYmVyX3NlY3Rpb25zOiB0cnVlCiAgICBwZGZfZG9jdW1lbnQ6CiAgICAgIHRvYzogdHJ1ZQogICAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUKICAgICAgbGF0ZXhfZW5naW5lOiB4ZWxhdGV4Ci0tLQoKIyBCYWNrZ3JvdW5kIAoKUmVzZWFyY2hlcnMgYXJlIHN0dWR5aW5nIHRoZSBpbXBhY3Qgb2YgcHJvdGVpbiBzb3VyY2VzIGFuZCBwcm90ZWluIGxldmVscyBpbiAKdGhlIGRpZXQgb24gdGhlIHdlaWdodCBvZiByYXRzLiBUaGV5IGZlZWQgdGhlIHJhdHMgd2l0aCBkaWV0cyBvZiBiZWVmLCBjZXJlYWwgCmFuZCBwb3JrIGFuZCB1c2UgYSBsb3cgYW5kIGhpZ2ggcHJvdGVpbiBsZXZlbCBmb3IgZWFjaCBkaWV0IHR5cGUuIApUaGUgcmVzZWFyY2hlcnMgY2FuIGluY2x1ZGUgNjAgcmF0cyBpbiB0aGUgZXhwZXJpbWVudC4gUHJpb3IgdG8gdGhlIGV4cGVyaW1lbnQsCnRoZSByYXRzIHdlcmUgZGl2aWRlZCBpbiAxMCBob21vZ2VuZW91cyBncm91cHMgb2YgNiByYXRzIGJhc2VkIG9uIApjaGFyYWN0ZXJpc3RpY3Mgc3VjaCBhcyBpbml0aWFsIHdlaWdodCwgYXBwZXRpdGUsIGV0Yy4KCldpdGhpbiBlYWNoIGdyb3VwIGEgcmF0IGlzIHJhbmRvbWx5IGFzc2lnbmVkIHRvIGEgZGlldC4gVGhlIHJhdHMgYXJlIGZlZCBkdXJpbmcgCmEgbW9udGggYW5kIHRoZSB3ZWlnaHQgZ2FpbiBpbiBncmFtcyBpcyByZWNvcmRlZCBmb3IgZWFjaCByYXQuIAoKIyBFeHBlcmltZW50YWwgZGVzaWduIAoKLSBUaGVyZSBhcmUgdGhyZWUgZXhwbGFuYXRvcnkgdmFyaWFibGVzIGluIHRoZSBleHBlcmltZW50OiB0aGUgZmFjdG9yIGRpZXQgdHlwZQp3aXRoIHRocmVlIGxldmVscyAoYmVlZiwgY2VyZWFsIGFuZCBwb3JrKSwgZmFjdG9yIHByb3RlaW4gbGV2ZWwgd2l0aCBsZXZlbHMgCihsb3cgYW5kIGhpZ2gpIGFuZCBhIGdyb3VwIGJsb2NraW5nIGZhY3RvciB3aXRoIDEwIGxldmVscy4KCi0gVGhlcmUgYXJlIDYgdHJlYXRtZW50czogYmVlZi1oaWdoLCBjZXJlYWwtaGlnaCwgcG9yay1oaWdoLCBiZWVmLWxvdywgCmNlcmVhbC1sb3csIHBvcmstbG93IHByb3RlaW4uIAoKLSBUaGUgcmF0cyBhcmUgdGhlIGV4cGVyaW1lbnRhbCB1bml0cyAodGhlIHVuaXQgdG8gd2hpY2ggYSB0cmVhdG1lbnQgaXMgYXBwbGllZCk6IGluIHRoaXMgZGVzaWduLCB0aGVyZSBpcyBhIHJhbmRvbWlzYXRpb24gcmVzdHJpY3Rpb246IFdpdGhpbiBhIGJsb2NrLCBhIHJhdCBpcyByYW5kb21seSBhc3NpZ25lZCB0byBhIGRpZXQuCgotIFRoZSByYXRzIGFyZSB0aGUgb2JzZXJ2YXRpb25hbCB1bml0cyAodGhlIHVuaXQgb24gd2hpY2ggdGhlIHJlc3BvbnNlIGlzIG1lYXN1cmVkKTogVGhlIHdlaWdodCBpcyB3ZWlnaHRlZCBmb3IgZWFjaCByYXQuCgotIFRoZSB3ZWlnaHQgZ2FpbiBpcyB0aGUgcmVzcG9uc2UgdmFyaWFibGUuIAoKLSBUaGUgZXhwZXJpbWVudCBpcyBhIHJhbmRvbWl6ZWQgY29tcGxldGUgYmxvY2sgKFJDQikgZGVzaWduCgpMb2FkIGxpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQpgYGAKCiMgRGF0YSBpbXBvcnQKCmBgYHtyfQpkaWV0IDwtIHJlYWQudGFibGUoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGF0T21pY3MvUFNMUzIxL2RhdGEvZGlldFJhdHMudHh0IiwKICAgICAgICAgICAgICAgICAgIGhlYWRlcj1UUlVFKQpoZWFkKGRpZXQpCmBgYAoKIyBUaWR5IGRhdGEKCmBgYHtyfQpkaWV0IDwtIGRpZXQgJT4lCiAgbXV0YXRlKGJsb2NrID0gYXMuZmFjdG9yKGJsb2NrKSwKICAgICAgICAgcHJvdFNvdXJjZSA9IGFzLmZhY3Rvcihwcm90U291cmNlKSwKICAgICAgICAgcHJvdExldmVsID0gYXMuZmFjdG9yKHByb3RMZXZlbCkpICU+JQogIG11dGF0ZShwcm90TGV2ZWwgPSBmY3RfcmVsZXZlbChwcm90TGV2ZWwsICJsIikpCmBgYAoKIyBEYXRhIGV4cGxvcmF0aW9uCgotIEJveHBsb3Qgb2YgdGhlIHdlaWdodCBnYWluIGFnYWluc3QgcHJvdGVpbiBzb3VyY2UsIHByb3RlaW4gbGV2ZWwgd2l0aCBjb2xvcmluZyBhY2NvcmRpbmcgdG8gYmxvY2sKCmBgYHtyfQpkaWV0ICU+JSAKICBnZ3Bsb3QoYWVzKHg9cHJvdExldmVsLCB5PXdlaWdodEdhaW4pKSArIAogICAgc2NhbGVfZmlsbF9icmV3ZXIocGFsZXR0ZT0iUmRHeSIpICsKICAgIHRoZW1lX2J3KCkgKwogICAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGU9TkEpICsgCiAgICBnZW9tX2ppdHRlcihhZXMoY29sb3I9YmxvY2spKSArCiAgICBnZ3RpdGxlKCJXZWlnaHQgZ2FpbiBkZXBlbmRlbmNlIG9uIHByb3RlaW4gc291cmNlIikgKwogICAgeWxhYigiV2VpZ3RoIGdhaW4gKGcpIikgKyAKICAgICNzdGF0X3N1bW1hcnkoZnVuID0gbWVhbiwgZ2VvbT0icG9pbnQiLCBzaGFwZT01LCBzaXplPTMsIGNvbG9yPSJibGFjayIsIGZpbGw9ImJsYWNrIikgKwogICAgZmFjZXRfd3JhcCgufnByb3RTb3VyY2UpCmBgYAoKLSBMaW5lcGxvdCBvZiB0aGUgd2VpZ2h0IGdhaW4gYWdhaW5zdCBwcm90ZWluIHNvdXJjZSwgcHJvdGVpbiBsZXZlbCB3aXRoIGNvbG9yaW5nIGFuZCBncm91cGluZyBhY2NvcmRpbmcgdG8gYmxvY2sKCmBgYHtyfQpkaWV0ICU+JSAKICBnZ3Bsb3QoYWVzKHg9cHJvdFNvdXJjZTpwcm90TGV2ZWwsIHk9d2VpZ2h0R2FpbikpICsgCiAgICBzY2FsZV9maWxsX2JyZXdlcihwYWxldHRlPSJSZEd5IikgKwogICAgdGhlbWVfYncoKSArCiAgICBnZW9tX2xpbmUoYWVzKGdyb3VwPWJsb2NrLCBjb2xvcj1ibG9jaykpICsKICAgIGdlb21fcG9pbnQoYWVzKGNvbG9yPWJsb2NrKSkrCiAgICBnZ3RpdGxlKCJXZWlnaHQgZ2FpbiBkZXBlbmRlbmNlIG9uIHByb3RlaW4gc291cmNlIikgKwogICAgeWxhYigiV2VpZ3RoIGdhaW4gKGcpIikgCiAgICAjc3RhdF9zdW1tYXJ5KGZ1biA9IG1lYW4sIGdlb209InBvaW50Iiwgc2hhcGU9NSwgc2l6ZT0zLCBjb2xvcj0iYmxhY2siLCBmaWxsPSJibGFjayIpCmBgYAoKLSBBbiBpbmNyZWFzZSBpbiB0aGUgd2VpZ2h0IG9mIHRoZSByYXRzIHNlZW1zIHRvIGRlcGVuZCBvbiB0aGUgcHJvdGVpbiBzb3VyY2UKcmVjZWl2ZWQgaW4gdGhlIGRpZXQuCgotIFRoZSBpbmNyZWFzZSBpbiB0aGUgd2VpZ2h0IG9mIHRoZSByYXRzIHNlZW1zIHRvIGRlcGVuZCBvbiB0aGUgbGV2ZWwgb2YgcHJvdGVpbgpyZWNlaXZlZCBpbiB0aGUgZGlldAoKLSBUaGVyZSBhbHNvIHNlZW1zIHRvIGJlIGFuIGludGVyYWN0aW9uIGVmZmVjdCBiZXR3ZWVuIHRoZSBwcm90ZWluIGxldmVsIGFuZCB0aGUKcHJvdGVpbiBzb3VyY2Ugb24gdGhlIGdhaW4gaW4gd2VpZ2h0IG9mIHRoZSByYXRzLiBGb3IgdGhlIGJlZWYgYW5kIHRoZSBwb3JrIApkaWV0cyB0aGUgZWZmZWN0IG9mIGhpZ2ggcHJvdGVpbiBsZXZlbHMgaW4gdGhlIGRhdGEgc2VlbXMgdG8gYmUgbXVjaCBzdHJvbmdlcgp0aGFuIGluIHRoZSBjZXJlYWwgZGlldC4KCi0gVGhlcmUgaXMgYWxzbyBhIHN0cm9uZyBlZmZlY3Qgb2YgdGhlIGJsb2NrLiBCbG9ja2luZyBpbXBsaWVzIGEgcmFuZG9taXNhdGlvbiAKcmVzdHJpY3Rpb24sIGhlbmNlLCB3ZSB3aWxsIGhhdmUgdG8gaW5jbHVkZSB0aGUgYmxvY2sgZWZmZWN0IGFueXdheS4gCgojIE11bHRpdmFyaWF0ZSBsaW5lYXIgcmVncmVzc2lvbiBhbmFseXNpcwoKIyMgQXNzdW1wdGlvbnMgCgpMaXN0IGFzc3VtcHRpb25zOgoKMS4gVGhlIG9ic2VydmF0aW9ucyBhcmUgaW5kZXBlbmRlbnQgCjIuIExpbmVhcml0eSBiZXR3ZWVuIHRoZSByZXNwb25zZSBhbmQgcHJlZGljdG9yIHZhcmlhYmxlCjMuIFRoZSByZXNpZHVhbHMgb2YgdGhlIG1vZGVsIG11c3QgYmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQKNC4gSG9tb3NjZWRhc3RpY2l0eSBvZiB0aGUgZGF0YQoKVGhlIGZpcnN0IGFzc3VtcHRpb24gaXMgbWV0IGlmIHdlIGNvcnJlY3QgZm9yIGJsb2NrIGluIHRoZSBtb2RlbCBiZWNhdXNlIHRoZSByYXRzIHdlcmUgcmFuZG9taXplZCB0byB0aGUgdHJlYXRtZW50IHdpdGhpbiBibG9jay4gVGhlIG90aGVyIHRocmVlIGFzc3VtcHRpb25zIGNhbiBiZSBhc3Nlc3NlZCBieQpmaXR0aW5nIHRoZSBsaW5lYXIgbW9kZWwgYW5kIGNhbGxpbmcgdGhlIGBwbG90KClgIGZ1bmN0aW9uIGFzIGZvbGxvd3MuCgpgYGB7cn0KbG0xIDwtIGxtKHdlaWdodEdhaW4gfiBibG9jayArIHByb3RTb3VyY2UqcHJvdExldmVsLCBkYXRhPWRpZXQpCnBsb3QobG0xKQpgYGAKCkFsbCBhc3N1bXB0aW9ucyBhcmUgbWV0IGZvciB0aGlzIGRhdGFzZXQuCgojIyBIeXBvdGhlc2lzIHRlc3RpbmcKCldlIGhlcmUgZml0IGEgbGluZWFyIG1vZGVsIHdpdGggYSBibG9ja2luZyBmYWN0b3IgZm9yIGBibG9ja2AgYW5kIG1haW4gYW5kIAppbnRlcmFjdGlvbiBlZmZlY3RzIGZvciBwcm90ZWluIHNvdXJjZSBhbmQgcHJvdGVpbiBsZXZlbC4KCmBgYHtyfQpzdW1tYXJ5KGxtMSkKYGBgCgojIyBJbnRlcnByZXRhdGlvbiBvZiB0aGUgcmVncmVzc2lvbiBwYXJhbWV0ZXJzCgpgYGB7cn0KbGlicmFyeShFeHBsb3JlTW9kZWxNYXRyaXgpCkV4cGxvcmVNb2RlbE1hdHJpeDo6VmlzdWFsaXplRGVzaWduKGRpZXQsIH4gYmxvY2sgKyBwcm90U291cmNlICogcHJvdExldmVsKSRwbG90bGlzdApgYGAKClRoZXJlIGFyZSAzIGxldmVscyBmb3IgcHJvdGVpbiBzb3VyY2UsIDIgbGV2ZWxzIGZvciBwcm90ZWluIGxldmVsIGFuZCAxMCBsZXZlbHMKZm9yIHRoZSBibG9ja2luZyB2YXJpYWJsZS4gV2Ugd2lsbCBoYXZlIG9uZSByZWZlcmVuY2UgbGV2ZWwgZm9yIGVhY2ggcmVzcGVjdGl2ZSAKdmFyaWFibGU6IGJlZWYsIGxvdywgYmxvY2sgMS4gU28gd2UgbmVlZCAyLCAxIGFuZCA5IGR1bW15IHZhcmlhYmxlcyB0byBpbnRyb2R1Y2UgCnRoZSBmYWN0b3JzIHByb3RlaW4gc291cmNlLCBwcm90ZWluIGxldmVsIGFuZCBibG9jayBpbiB0aGUgbGluZWFyIG1vZGVsLCAKcmVzcGVjdGl2ZWx5LgoKSGVuY2UsIHdlIGNhbiB3cml0ZSBkb3duIHRoZSBsaW5lYXIgbW9kZWwgYXMgZm9sbG93czoKCiR5X2k9XGJldGFfMCtcYmV0YV9jeF97aSxjfSArXGJldGFfcHhfe2kscH0rXGJldGFfaHhfe2ksaH0rXGJldGFfe2NofXhfe2ksY314X3tpLGh9K1xiZXRhX3twaH14X3tpLHB9eF97aSxofStcYmV0YV97YjJ9eF97aSxiMn0rXGxkb3RzK1xiZXRhX3tiMTB9eF97aSxiMTB9K1xlcHNpbG9uX3tpfSQKCndpdGg6CiR5X2kkIHRoZSBvYnNlcnZlZCB3ZWlnaHQgZ2FpbiBmb3IgcmF0IGksIAokeF97aSxofSQgYSBkdW1teSB2YXJpYWJsZSB3aGljaCBpcyAxIGlmIHJhdCBpIHJlY2VpdmVzIGEgaGlnaCBwcm90ZWluIGRpZXQgCmFuZCBpcyAwIG90aGVyd2lzZSwgIAokeF97aSxjfSQgYSBkdW1teSB2YXJpYWJsZSB3aGljaCBpcyAxIGlmIHJhdCBpIHJlY2VpdmVzIGEgY2VyZWFsIGRpZXQgCmFuZCBpcyAwIG90aGVyd2lzZSwgIAokeF97aSxwfSQgYSBkdW1teSB2YXJpYWJsZSB3aGljaCBpcyAxIGlmIHJhdCBpIHJlY2VpdmVzIGEgcG9yayBkaWV0IAphbmQgaXMgMCBvdGhlcndpc2UgYW5kIAokeF97aSxia30kIGlzIGEgZHVtbXkgdmFyaWFibGUgd2hpY2ggaXMgMSBpZiByYXQgaSBiZWxvbmdzIHRvIGJsb2NrICRiayQgCmFuZCBpcyAwIG90aGVyd2lzZSwgd2l0aCAkayBcaW4gMixcbGRvdHMsIDEwJCwgCmFuZCAkXGVwc2lsb25faSQgYW4gZXJyb3IgdGVybSB3aGljaCBpcyBub3JtYWxseSBkaXN0cmlidXRlZCB3aXRoIG1lYW4gMCBhbmQgCnZhcmlhbmNlICRcc2lnbWFeMiQsIGkuZS4gJFxlcHNpbG9uX2kgXHNpbSBOKDAsXHNpZ21hXjIpJC4KCi0gUmF0cyB0aGF0IGFyZSBhc3NpZ25lZCB0byBibG9jayAkayQgYW5kIHJlY2VpdmUgYSBiZWVmIGJhc2VkIGxvdyBwcm90ZWluIGRpZXQgaGF2ZQoJYSBjb3ZhcmlhdGUgcGF0dGVybiAkeF97aSxofT0wJCwgJHhfe2ksY309MCQsICR4X3tpLHB9PTAkLCAkeF97aSxibX09MCQgd2l0aCAkbVxuZXEgayQgYW5kICR4X3tpLGJrfT0xJC4gCglUaGVpciBtZWFuIHdlaWdodCBnYWluIGlzIHRodXMgZXF1YWwgdG8gJFxtdV97bCxiLGJrfT1cYmV0YV8wK1xiZXRhX3tia30kCgotIFJhdHMgdGhhdCBhcmUgYXNzaWduZWQgdG8gYmxvY2sgJGskIGFuZCByZWNlaXZlIGEgYmVlZiBiYXNlZCBoaWdoIHByb3RlaW4gZGlldCBoYXZlCglhIGNvdmFyaWF0ZSBwYXR0ZXJuICR4X3tpLGh9PTEkLCAkeF97aSxjfT0wJCwgJHhfe2kscH09MCQsICR4X3tpLGJtfT0wJCB3aXRoICRtXG5lcSBrJCBhbmQgJHhfe2ksYmt9PTEkLiAKCVRoZWlyIG1lYW4gd2VpZ2h0IGdhaW4gaXMgdGh1cyBlcXVhbCB0byAkXG11X3toLGIsYmt9PVxiZXRhXzArXGJldGFfaCtcYmV0YV97Ymt9JAoKLSBSYXRzIHRoYXQgYXJlIGFzc2lnbmVkIHRvIGJsb2NrICRrJCBhbmQgcmVjZWl2ZSBhIGNlcmVhbCBiYXNlZCBsb3cgcHJvdGVpbiBkaWV0IGhhdmUKCWEgY292YXJpYXRlIHBhdHRlcm4gJHhfe2ksaH09MCQsICR4X3tpLGN9PTEkLCAkeF97aSxwfT0wJCwgJHhfe2ksYm19PTAkIHdpdGggJG1cbmVxIGskIGFuZCAkeF97aSxia309MSQuIAoJVGhlaXIgbWVhbiB3ZWlnaHQgZ2FpbiBpcyB0aHVzIGVxdWFsIHRvICRcbXVfe2gsYyxia309XGJldGFfMCtcYmV0YV9jK1xiZXRhX3tia30kCgotIFJhdHMgdGhhdCBhcmUgYXNzaWduZWQgdG8gYmxvY2sgJGskIGFuZCByZWNlaXZlIGEgY2VyZWFsIGJhc2VkIGhlaWdoIHByb3RlaW4gZGlldCBoYXZlCglhIGNvdmFyaWF0ZSBwYXR0ZXJuICR4X3tpLGh9PTEkLCAkeF97aSxjfT0xJCwgJHhfe2kscH09MCQsICR4X3tpLGJtfT0wJCB3aXRoICRtXG5lcSBrJCBhbmQgJHhfe2ksYmt9PTEkLiAKCVRoZWlyIG1lYW4gd2VpZ2h0IGdhaW4gaXMgdGh1cyBlcXVhbCB0byAkXG11X3toLGMsYmt9PVxiZXRhXzArXGJldGFfaCtcYmV0YV9jK1xiZXRhX3tjaH0rXGJldGFfe2JrfSQKCi0gUmF0cyB0aGF0IGFyZSBhc3NpZ25lZCB0byBibG9jayAkayQgYW5kIHJlY2VpdmUgYSBwb3JrIGJhc2VkIGxvdyBwcm90ZWluIGRpZXQgaGF2ZQoJYSBjb3ZhcmlhdGUgcGF0dGVybiAkeF97aSxofT0wJCwgICR4X3tpLGN9PTAkLCAkeF97aSxwfT0xJCwgJHhfe2ksYm19PTAkIHdpdGggJG1cbmVxIGskIGFuZCAkeF97aSxia309MSQuIAoJVGhlaXIgbWVhbiB3ZWlnaHQgZ2FpbiBpcyB0aHVzIGVxdWFsIHRvICRcbXVfe2wscCxia309XGJldGFfMCtcYmV0YV9wK1xiZXRhX3tia30kCgotIFJhdHMgdGhhdCBhcmUgYXNzaWduZWQgdG8gYmxvY2sgJGskIGFuZCByZWNlaXZlIGEgcG9yayBiYXNlZCBoZWlnaCBwcm90ZWluIGRpZXQgaGF2ZQoJYSBjb3ZhcmlhdGUgcGF0dGVybiAkeF97aSxofT0xJCwgJHhfe2ksY309MCQsICR4X3tpLHB9PTEkLCAkeF97aSxibX09MCQgd2l0aCAkbVxuZXEgayQgYW5kICR4X3tpLGJrfT0xJC4gCglUaGVyZSBtZWFuIHdlaWdodCBnYWluIGlzIHRodXMgZXF1YWwgdG8gJFxtdV97aCxwLGJrfT1cYmV0YV8wK1xiZXRhX2grXGJldGFfcCtcYmV0YV97cGh9K1xiZXRhX3tia30kCgkKV2UgY2FuIG5vdyByZWxhdGUgdGhpcyB0byB0aGUgb3V0cHV0IG9mIHRoZSBgbG1gIGZ1bmN0aW9uOgoKLSBUaGUgaW50ZXJjZXB0ICRcYmV0YV8wJCBpcyB0aHVzIHRoZSBhdmVyYWdlIHdlaWdodCBpbmNyZWFzZSBpbiB0aGUgbG93IGJlZWYgCmRpZXQgZm9yIHJhdHMgaW4gYmxvY2sgMS4KCi0gVGhlIHBhcmFtZXRlciAkXGJldGFfYyQ6IHRoZSBhdmVyYWdlIGRpZmZlcmVuY2UgaW4gd2VpZ2h0IGdhaW4gYmV0d2VlbiBjZXJlYWwtbG93IGFuZCAKYmVlZi1sb3cgZGlldCBpcyBgciBsbTEkY29lZlsicHJvdFNvdXJjZWMiXWBnLgoKLSBUaGUgcGFyYW1ldGVyICRcYmV0YV9wJDogdGhlIGF2ZXJhZ2UgZGlmZmVyZW5jZSBpbiB3ZWlnaHQgZ2FpbiBiZXR3ZWVuIHBvcmstbG93IGFuZCAKYmVlZi1sb3cgZGlldCBpcyBgciBsbTEkY29lZlsicHJvdFNvdXJjZXAiXWBnLgoKLSBUaGUgcGFyYW1ldGVyICRcYmV0YV9oJDogdGhlIGF2ZXJhZ2UgZGlmZmVyZW5jZSBpbiB3ZWlnaHQgZ2FpbiBiZXR3ZWVuIGJlZWYtaGlnaCBhbmQgCmJlZWYtTG93IGRpZXQgaXMgYHIgbG0xJGNvZWZbInByb3RMZXZlbGgiXWBnLgoKLSBUaGUgcGFyYW1ldGVyICRcYmV0YV97Y2h9JCBpcyB0aGUgZGlmZmVyZW5jZSBpbiB0aGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbiBkaWZmZXJlbmNlIApkdWUgdG8gdGhlIGhpZ2ggcHJvdGVpbiBsZXZlbCBhcyBjb21wYXJlZCB0byB0aGUgbG93IHByb3RlaW4gbGV2ZWwgZm9yIGNlcmVhbCBkaWV0cyAKYXMgY29tcGFyZWQgdG8gdGhlIHdlaWdodCBnYWluIGRpZmZlcmVuY2UgdGhhdCBvY2N1cnMgZHVlIHRvIHRoZSBwcm90ZWluIGxldmVsCmluIHRoZSByZWZlcmVuY2UgY2xhc3MgKGhlcmUgYmVlZiBkaWV0KS4gSGVyZSB0aGlzIGlzIG5lZ2F0aXZlLCAKaS5lLiBgciBsbTEkY29lZlsicHJvdFNvdXJjZWM6cHJvdExldmVsaCJdYGcsIHRodXMgdGhlIHdlaWdodCBnYWluIApmb3IgdGhlIGNlcmVhbCBwcm90ZWluIHNvdXJjZSBpbmNyZWFzZXMgb24gYXZlcmFnZSBsZXNzIGJldHdlZW4gaGlnaCBhbmQgbG93IHByb3RlaW4gZGlldHMgCnRoYW4gaW4gYmVlZiBiYXNlZCBkaWV0cy4KCi0gVGhlIHBhcmFtZXRlciAkXGJldGFfe3BofSQgaXMgdGhlIGRpZmZlcmVuY2UgaW4gdGhlIGF2ZXJhZ2Ugd2VpZ2h0IGdhaW4gZGlmZmVyZW5jZSAKZHVlIHRvIHRoZSBoaWdoIHByb3RlaW4gbGV2ZWwgYXMgY29tcGFyZWQgdG8gdGhlIGxvdyBwcm90ZWluIGxldmVsIGZvciBwb3JrIGRpZXRzIAphcyBjb21wYXJlZCB0byB0aGUgd2VpZ2h0IGdhaW4gZGlmZmVyZW5jZSB0aGF0IG9jY3VycyBkdWUgdG8gdGhlIHByb3RlaW4gbGV2ZWwKaW4gdGhlIHJlZmVyZW5jZSBjbGFzcyAoaGVyZSBiZWVmIGRpZXQpLiBIZXJlIHRoaXMgaXMgbmVnYXRpdmUsIAppLmUuIGByIGxtMSRjb2VmWyJwcm90U291cmNlcDpwcm90TGV2ZWxoIl1gZywgdGh1cyB0aGUgd2VpZ2h0IGdhaW4gCmZvciB0aGUgcHJvYyBwcm90ZWluIHNvdXJjZSBpbmNyZWFzZXMgb24gYXZlcmFnZSBsZXNzIGJldHdlZW4gaGlnaCBhbmQgbG93IHByb3RlaW4gZGlldHMgCnRoYW4gaW4gYmVlZiBiYXNlZCBkaWV0cy4KCiMjIFRlc3RpbmcgdGhlIG92ZXJhbGwgKGNvbWJpbmVkKSBlZmZlY3Qgb2YgZGlldAoKQmVjYXVzZSB0aGVyZSBhcmUgbXVsdGlwbGUgZmFjdG9ycyB3aXRoIGRpZmZlcmVudCBsZXZlbHMgaW4gdGhlIG1vZGVsLCAKd2UgY2FuIGZpcnN0IGFzc2VzcyB0aGUgZWZmZWN0IG9mIHRoZSBkaWV0IChwcm90ZWluIExldmVsLCBwcm90ZWluIHNvdXJjZSAKYW5kIHRoZSBpbnRlcmFjdGlvbikgYnkgdXNpbmcgYW5vdmEuIFdpdGggdGhpcyB0ZXN0IHdlIHdpbGwgYXNzZXNzIHRoZSBudWxsCmh5cG90aGVzaXMgdGhhdCB0aGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbiBpbiBlYWNoIHRyZWF0bWVudCBpcyBlcXVhbDogaS5lLiAkSF8wOiBcbXVfe2IsbH09XG11X3tiLGh9PVxtdV97YyxofT1cbXVfe2MsbH09XG11X3twLGh9PVxtdV97cCxofSQgdmVyc3VzIAp0aGUgYWx0ZXJuYXRpdmUgaHlwdG9oZXNpcyAkSF8xOiQgdGhhdCBhdCBsZWFzdCB0d28gdHJlYXRtZW50IG1lYW5zIGFyZSAKZGlmZmVyZW50LiAKCmBgYHtyfQpsbTAgPC0gbG0od2VpZ2h0R2FpbiB+IGJsb2NrLCBkYXRhPWRpZXQpCmFub3ZhKGxtMCwgbG0xKQpgYGAKCldlIGNhbiBjb25jbHVkZSB0aGF0IHRoZXJlIGlzIGFuIGV4dHJlbWVseSBzaWduaWZpY2FudCBlZmZlY3Qgb2YgdGhlIGRpZXQgdHlwZSAKKHByb3RlaW4gc291cmNlIGFuZC9vciBwcm90ZWluIGxldmVsIGFuZC9vciBwcm90ZWluIHNvdXJjZS1wcm90ZWluIGxldmVsIAppbnRlcmFjdGlvbikgb24gdGhlIHdlaWdodCBnYWluIG9mIHJhdHMgKHAgPDwgMC4wMDEpLgoKIyMgQXNzZXNzaW5nIHRoZSBpbnRlcmFjdGlvbiBlZmZlY3QgYmV0d2VlbiBwcm90ZWluIHNvdXJjZSBhbmQgcHJvdGVpbiBsZXZlbAoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkoY2FyKQpBbm92YShsbTEsIHR5cGU9IklJSSIpCmBgYAoKVGhlcmUgaXMgYSB2ZXJ5IHNpZ25pZmljYW50IGludGVyYWN0aW9uIGJldHdlZW4gdGhlIHByb3RlaW4gc291cmNlIGFuZCAKdGhlIHByb3RlaW4gbGV2ZWwgKHAgPSBgciBmb3JtYXQoQW5vdmEobG0xLCB0eXBlPTMpJCJQcig+RikiLGRpZ2l0cz0xKVs1XWApLiBUaGlzIGluZGljYXRlcyB0aGF0IHRoZSBhdmVyYWdlIHdlaWdodCBpbmNyZWFzZSBkdWUgdG8gCnRoZSBwcm90ZWluIGxldmVsIGRpZmZlcnMgYWNjb3JkaW5nIHRvIHRoZSBwcm90ZWluIHNvdXJjZS4gCkhlbmNlLCB3ZSBjYW5ub3QgYXNzZXNzIHRoZSBlZmZlY3Qgb2YgdGhlIHByb3RlaW4gc291cmNlIGFuZC9vciBwcm90ZWluIGxldmVsIAppbmRlcGVuZGVudGx5IGJlY2F1c2UgdGhlcmUgZWZmZWN0cyBvZiB0aGUgcHJvdGVpbiBzb3VyY2UgdmFyeSBhY2NvcmRpbmcgdG8gCnRoZSBwcm90ZWluIGxldmVsLgoKIyMgQXNzZXNzaW5nIHNwZWNpZmljIGNvbnRyYXN0cwoKSW1hZ2luZSB0aGF0IHdlIGFyZSBpbnRlcmVzdGVkIGluIGFzc2Vzc2luZyBpZiB0aGVyZSBpcyBhbiBlZmZlY3Qgb2YKIAoxLiBwcm90ZWluIHNvdXJjZSBpbiB0aGUgbG93IHByb3RlaW4gZGlldHMgCgktICRcbXVfe2MsbH0tXG11X3tiLGx9ID0gXGJldGFfYyQKCS0gJFxtdV97cCxsfS1cbXVfe2IsbH0gPSBcYmV0YV9wJAoJLSAkXG11X3tjLGx9LVxtdV97cCxsfT0gXGJldGFfYy1cYmV0YV9wJCkKCgoyLiBwcm90ZWluIHNvdXJjZSBpbiBoaWdoIHByb3RlaW4gZGlldHMgCgktICRcbXVfe2MsaH0tXG11X3tiLGh9PVxiZXRhX2MrXGJldGFfe2NofSQKCS0gJFxtdV97cCxofS1cbXVfe2IsaH09XGJldGFfcCtcYmV0YV97cGh9JAoJLSAkXG11X3twLGh9LVxtdV97YyxofT0oXGJldGFfYytcYmV0YV97Y2h9KS0oXGJldGFfcCtcYmV0YV97cGh9KSQKCgozLiBwcm90ZWluIGxldmVsIGZvcgoJLSBiZWVmIGRpZXRzICgkXG11X3tiLGh9LVxtdV97YixsfT1cYmV0YV9oJCksIAoJLSBjZXJlYWwgZGlldHMgICgkXG11X3tjLGh9LVxtdV97YyxsfT1cYmV0YV9oK1xiZXRhX3tjaH0kKSBhbmQgCgktIHBvcmsgZGlldHMgICgkXG11X3twLGh9LVxtdV97cCxsfT1cYmV0YV9oK1xiZXRhX3twaH0kKS4KCgo0LiBJZiB0aGUgZWZmZWN0IG9mIHRoZSBwcm90ZWluIGxldmVsIGRpZmZlcnMgYmV0d2VlbgoJLSBiZWVmIGFuZCBjZXJlYWwgICQoXG11X3tjLGh9LVxtdV97YyxsfSkgLSAoXG11X3tiLGh9LVxtdV97YixsfSk9XGJldGFfe2NofSQKCS0gYmVlZiBhbmQgcG9yayAkKFxtdV97cCxofS1cbXVfe3AsbH0pIC0gKFxtdV97YyxofS1cbXVfe2MsbH0pPVxiZXRhX3twaH0kIGFuZAoJLSBjZXJlYWwgYW5kIHBvcmsgZGlldHMgJChcbXVfe2MsaH0tXG11X3tjLGx9KSAtIChcbXVfe3AsaH0tXG11X3twLGx9KT1cYmV0YV97Y2h9LVxiZXRhX3twaH0kLgoKVGhlc2UgZWZmZWN0cyBvZiBpbnRlcmVzdCBhcmUgc28tY2FsbGVkIAoqKmNvbnRyYXN0cywgaS5lLiBsaW5lYXIgY29tYmluYXRpb25zIG9mIHRoZSBwYXJhbWV0ZXJzKiouCgpXZSBjYW4gZGVmaW5lIHRoZSBjb250cmFzdHMgYW5kIGFzc2VzcyB0aGUgc2lnbmlmaWNhbmNlIG9mIHRoZSBjb250cmFzdHMgd2l0aCAKdGhlIGNvZGUgYmVsb3cuIFRoZSBjb250cmFzdHMgYXJlIGdpdmVuIGFzIGlucHV0IGluIHRoZSBmb3JtIG9mIHN5bWJvbGljCmRlc2NyaXB0aW9ucyB0byB0aGUgYGxpbmZjdGAgYXJndW1lbnQgb2YgdGhlIGBnbGh0YCBmdW5jdGlvbi4KCmBgYHtyLG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkobXVsdGNvbXApCnNldC5zZWVkKDc1NDY4KSAjIHRvIGdldCByZXByb2R1Y2libGUgcmVzdWx0cyAoc21hbGwgZWZmZWN0IGlmIHJlbW92ZWQpCmxtMU11bHRDb21wIDwtIGdsaHQoCiAgICBtb2RlbCA9IGxtMSwKICAgIGxpbmZjdCA9IGMoInByb3RTb3VyY2VjID0gMCIsCiAgICAgICAgICAgICAgICJwcm90U291cmNlcCA9IDAiLAogICAgICAgICAgICAgICAicHJvdFNvdXJjZWMtIHByb3RTb3VyY2VwID0gMCIsCiAgICAgICAgICAgICAgICJwcm90U291cmNlYyArIHByb3RTb3VyY2VjOnByb3RMZXZlbGggPSAwIiwKICAgICAgICAgICAgICAgInByb3RTb3VyY2VwICsgcHJvdFNvdXJjZXA6cHJvdExldmVsaCA9IDAiLAogICAgICAgICAgICAgICAiKHByb3RTb3VyY2VjICsgcHJvdFNvdXJjZWM6cHJvdExldmVsaCkgLSAocHJvdFNvdXJjZXAgKyBwcm90U291cmNlcDpwcm90TGV2ZWxoKSA9IDAiLAogICAgICAgICAgICAgICAicHJvdExldmVsaCA9IDAiLAogICAgICAgICAgICAgICAicHJvdExldmVsaCArICBwcm90U291cmNlYzpwcm90TGV2ZWxoID0gMCIsCiAgICAgICAgICAgICAgICJwcm90TGV2ZWxoICsgIHByb3RTb3VyY2VwOnByb3RMZXZlbGggPSAwIiwKICAgICAgICAgICAgICAgInByb3RTb3VyY2VjOnByb3RMZXZlbGggPSAwIiwKICAgICAgICAgICAgICAgInByb3RTb3VyY2VwOnByb3RMZXZlbGggPSAwIiwKICAgICAgICAgICAgICAgInByb3RTb3VyY2VjOnByb3RMZXZlbGggLSBwcm90U291cmNlcDpwcm90TGV2ZWxoID0gMCIpCikKYGBgCgpgYGB7cn0Kc3VtbWFyeShsbTFNdWx0Q29tcCkKYGBgCgpgYGB7cn0KY29uZmludChsbTFNdWx0Q29tcCkKYGBgCgpOb3RlIHRoYXQgdGhlIHAtdmFsdWVzIGFuZCB0aGUgY29uZmlkZW5jZSBpbnRlcnZhbHMgYXJlIGF1dG9tYXRpY2FsbHkgY29ycmVjdGVkIApmb3IgbXVsdGlwbGUgdGVzdGluZy4KCiMgQ29uY2x1c2lvbgoKLSBUaGVyZSBpcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9mIHRoZSB0eXBlIG9mIHByb3RlaW4gZGlldCBvbiB0aGUgCndlaWdodCBnYWluIG9mIHJhdHMgIChwPDwxZS02KS4gVGhlIGludGVyYWN0aW9uIGJldHdlZW4gcHJvdGVpbiB0eXBlIGFuZCBwcm90ZWluIApzb3VyY2UgaXMgYWxzbyB2ZXJ5IHNpZ25pZmljYW50IChwPWByIHJvdW5kKEFub3ZhKGxtMSx0eXBlPTMpJFByWzVdLDQpYCkuIAoKLSBUaGUgYXZlcmFnZSB3ZWlnaHQgZ2FpbiBkb2VzIG5vdCB2YXJ5IHNpZ25pZmljYW50bHkgYWNjb3JkaW5nIHRvIHByb3RlaW4gCnNvdXJjZSBpbiB0aGUgZGlldHMgd2l0aCBsb3cgcHJvdGVpbiBsZXZlbHMgKGFsbCBwPjAuOTkpLiAKCi0gVGhlIHdlaWdodCBnYWluIGluIHRoZSBjZXJlYWwgZGlldCBhdCBoaWdoIHByb3RlaW4gY29uY2VudHJhdGlvbiBpcyBvbiAKYXZlcmFnZSBgciBjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90U291cmNlYyArIHByb3RTb3VyY2VjOnByb3RMZXZlbGgiLDFdICU+JSBhYnMgJT4lIHJvdW5kKC4sMSlgZyBhbmQgYHIgY29uZmludChsbTFNdWx0Q29tcCkkY29uZmludFsiKHByb3RTb3VyY2VjICsgcHJvdFNvdXJjZWM6cHJvdExldmVsaCkgLSAocHJvdFNvdXJjZXAgKyBwcm90U291cmNlcDpwcm90TGV2ZWxoKSIsMV0gJT4lIGFicyAlPiUgcm91bmQoLiwxKWBnIGcgbG93ZXIgdGhhbiBpbiB0aGUgaGlnaCBwcm90ZWluIGJlZWYgYW5kIHBvcmsgZGlldCwgCnJlc3BlY3RpdmVseSAoOTUlIENJIFtgciBjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90U291cmNlYyArIHByb3RTb3VyY2VjOnByb3RMZXZlbGgiLC0xXSAlPiUgYWJzICU+JSByb3VuZCguLDEpICU+JSBzb3J0YF0gYW5kIFtgciBjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyIocHJvdFNvdXJjZWMgKyBwcm90U291cmNlYzpwcm90TGV2ZWxoKSAtIChwcm90U291cmNlcCArIHByb3RTb3VyY2VwOnByb3RMZXZlbGgpIiwtMV0gJT4lIGFicyAlPiUgcm91bmQoLiwxKSAlPiUgc29ydGBdKSBhbmQgdGhlIGRpZmZlcmVuY2VzIGFyZSAKZXh0cmVtZWx5IHNpZ25pZmljYW50IChwPDAuMDAxKS4gVGhlIGF2ZXJhZ2Ugd2VpZ2h0IGdhaW5zIGFmdGVyIG1lYXQgYmFzZWQgCmRpZXRzIGF0IGhpZ2ggcHJvdGVpbiBsZXZlbHMsIGhvd2V2ZXIsIGRvIG5vdCBkaWZmZXIgc2lnbmlmaWNhbnRseSAKKHA+MC45OSkuCgotIFdlIGFsc28gZGlzY292ZXJlZCBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBpbiB3ZWlnaHQgZ2FpbiAKYWNjb3JkaW5nIHRvIHRoZSBwcm90ZWluIGxldmVsIGZvciBiZWVmIGFuZCBwb3JrIGJhc2VkIGRpZXRzIChwPDAuMDAxKS4gIApUaGUgd2VpZ2h0IGdhaW4gb24gYXZlcmFnZSBpbmNyZWFzZXMgd2l0aCBgciByb3VuZChjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90TGV2ZWxoIiwxXSwxKWBnIGFuZCBgciByb3VuZChjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90TGV2ZWxoICsgcHJvdFNvdXJjZXA6cHJvdExldmVsaCIsMV0sMSlgZyBpbiB0aGUgaGlnaCBwcm90ZWluIApsZXZlbCBhcyBjb21wYXJlZCB0byB0aGUgbG93IHByb3RlaW4gYmVlZiBhbmQgcG9yayBkaWV0LCByZXNwZWN0aXZlbHkgCig5NSVDSSBbYHIgcm91bmQoY29uZmludChsbTFNdWx0Q29tcCkkY29uZmludFsicHJvdExldmVsaCIsLTFdLDEpYF0gYW5kIFtgciByb3VuZChjb25maW50KGxtMU11bHRDb21wKSRjb25maW50WyJwcm90TGV2ZWxoICsgcHJvdFNvdXJjZXA6cHJvdExldmVsaCIsLTFdLDEpYF0pLiBUaGUgcHJvdGVpbiBsZXZlbCBlZmZlY3QgaXMgbm90IHNpZ25pZmljYW50CmZvciB0aGUgY2VyZWFsIGRpZXQgKHA+MC45OSkuIAoKLSBGaW5hbGx5IHNpZ25pZmljYW50IGludGVyYWN0aW9ucyBiZXR3ZWVuIHByb3RlaW4gbGV2ZWwgYW5kIHByb3RlaW4gc291cmNlIHdlcmUKZm91bmQgKHA8MC4wNSksIGkuZS4gdGhlIGluY3JlYXNlIGluIHdlaWdodCBnYWluIGR1ZSB0byBwcm90ZWluIGxldmVsIGluIGNlcmVhbApiYXNlZCBkaWV0cyB3YXMgMTguMmcgYW5kIDE2LjVnIGxvd2VyIHRoYW4gdGhhdCBvZiBiZWVmIGFuZCBwb3JrIGJhc2VkIGRpZXRzLApyZXNwZWN0aXZlbHkgKDk1JSBDSSBbM2csMzMuNGddIGFuZCBbMS4zZywzMS43Z10pLiBUaGUgYXZlcmFnZSBkaWZmZXJlbmNlIGluIAppbmNyZWFzZSBpbiB3ZWlnaHQgZ2FpbiBkdWUgdG8gcHJvdGVpbiBsZXZlbCBhbW9uZyB0aGUgbWVhdCBiYXNlZCBkaWV0cyB3YXMgbm90IApzaWduaWZpY2FudCAocD4wLjk5KS4KCkFsbCByZXBvcnRlZCBwLXZhbHVlcyBhbmQgY29uZmlkZW5jZSBpbnRlcnZhbHMgd2VyZSBjb3JyZWN0ZWQgZm9yIG11bHRpcGxlIAp0ZXN0aW5nCg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Rats_02.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
